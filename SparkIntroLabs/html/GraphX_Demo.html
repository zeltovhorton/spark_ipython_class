<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<title>GraphX Demo - Databricks</title>
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">
<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
<link rel='stylesheet' type='text/css' href='https://databricks-prod-cloudfront.cloud.databricks.com/static/201510301624390700-ce350f0a9622b7b742da5cf8d5cb0e2b75e1c4c7-dirty/notebook.css'></style>
<style media='print'>
#context-bar,div.top-menu-buttons,div.globalComments,div.commentsPane,.tb-title-icons,#topbar,#user-menu{position:relative !important}#help-menu{position:relative !important}#topbar{display:block !important;height:auto !important}.tb-button{display:none !important}.tb-title-wrapper{text-align:left !important;margin:0;left:0;white-space:initial;position:relative}.tb-title-lang{display:none !important}#overallView{left:0 !important}#content{position:relative !important;display:block !important;top:0 !important;left:0 !important}.command-provenance{visibility:visible !important;opacity:1 !important}#context-bar,div.top-menu-buttons,div.globalComments,div.commentsPane,.tb-title-icons,#tooltip,#filebrowser-popup,#searchpanel-popup,#user-menu{display:none !important}.submit-hint,a[class*="-button"],i[class*="icon-"],select{display:none !important}.results .plot-controls{display:none !important}a[class="cancel-query-button"]{display:block !important}.tb-status,.tb-status img{display:none !important}.command-result .spinner .spinner-wrapper{display:none !important}html,body,.shellSessionView{overflow:hidden !important}textarea:empty{display:none !important}div.primaryPrompt{display:none !important}div.divider{display:none !important}.command{border:none !important}*::-webkit-input-placeholder{color:tranparent}*:-moz-placeholder{color:tranparent}*::-moz-placeholder{color:tranparent}*:-ms-input-placeholder{color:tranparent}.expandingText{min-height:initial !important}.commentFrame .comment-list li{margin:0}.commentFrame .header{display:none !important}.commentFrame .new-comment{border-bottom:none !important}div.divider:hover{display:none !important}div.divider:hover .btn-circle{display:none !important}.command:hover,.command:active{border:none !important;box-shadow:none !important}@page{margin:2cm}body{max-width:100% !important}.ui-resizable{max-height:100%;max-width:100%}.figure-results-and-comments .widget[style*="width: auto; height: auto"]{width:100% !important;min-height:300px}.widget.widget-input{min-height:initial !important}@-moz-document url-prefix(){.ui-resizable{width:auto !important;height:auto !important;max-width:100%}}img,.figure,.ui-resizeable{page-break-inside:avoid}.previousPrompt{page-break-inside:avoid}.command .command-input .command-box{page-break-before:avoid}.results-and-comments{page-break-before:avoid}.results-and-comments.figure-results-and-comments{page-break-before:auto;page-break-inside:avoid}.command .ui-resizeable{page-break-inside:avoid}.table-bordered{border:1px solid #ddd}.results .table thead,.table thead{background:#fafafa}.command-result-wrapper .results{overflow:hidden}.results-table .inner{overflow:hidden}#content{overflow-y:visible}.commentFrame{overflow:visible;margin-bottom:25px}.commentFrame .new-comment{border-bottom:none}.commentFrame .main,.commentFrame .comment-list{overflow-y:visible;max-height:initial;height:auto}.sessionPane .shell-top>div:last-child .results{padding-bottom:50px;overflow:visible}
/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByaW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSx5R0FBeUcsNEJBQTRCLENBQUMsV0FBVyw0QkFBNEIsQ0FBQyxRQUFRLHlCQUF5QixzQkFBc0IsQ0FBQyxXQUFXLHVCQUF1QixDQUFDLGtCQUFrQiwyQkFBMkIsU0FBUyxPQUFPLG9CQUFvQixpQkFBaUIsQ0FBQyxlQUFlLHVCQUF1QixDQUFDLGFBQWEsaUJBQWlCLENBQUMsU0FBUyw2QkFBNkIseUJBQXlCLGlCQUFpQixpQkFBaUIsQ0FBQyxvQkFBb0IsOEJBQThCLG9CQUFvQixDQUFDLGdKQUFnSix1QkFBdUIsQ0FBQywwREFBMEQsdUJBQXVCLENBQUMsd0JBQXdCLHVCQUF1QixDQUFDLCtCQUErQix3QkFBd0IsQ0FBQywwQkFBMEIsdUJBQXVCLENBQUMsMENBQTBDLHVCQUF1QixDQUFDLDRCQUE0QiwwQkFBMEIsQ0FBQyxlQUFlLHVCQUF1QixDQUFDLGtCQUFrQix1QkFBdUIsQ0FBQyxZQUFZLHVCQUF1QixDQUFDLFNBQVMsc0JBQXNCLENBQUMsNkJBQTZCLGdCQUFnQixDQUFDLG1CQUFtQixnQkFBZ0IsQ0FBQyxvQkFBb0IsZ0JBQWdCLENBQUMsd0JBQXdCLGdCQUFnQixDQUFDLGVBQWUsNkJBQTZCLENBQUMsK0JBQStCLFFBQVEsQ0FBQyxzQkFBc0IsdUJBQXVCLENBQUMsMkJBQTJCLDZCQUE2QixDQUFDLGtCQUFrQix1QkFBdUIsQ0FBQyw4QkFBOEIsdUJBQXVCLENBQUMsK0JBQStCLHVCQUF1QiwwQkFBMEIsQ0FBQyxNQUFNLFVBQVUsQ0FBQyxLQUFLLHlCQUF5QixDQUFDLGNBQWMsZ0JBQWdCLGNBQWMsQ0FBQyx5RUFBeUUsc0JBQXNCLGdCQUFnQixDQUFDLHFCQUFxQiw2QkFBNkIsQ0FBQyw0QkFBNEIsY0FBYyxzQkFBc0IsdUJBQXVCLGNBQWMsQ0FBQyxDQUFDLDJCQUEyQix1QkFBdUIsQ0FBQyxnQkFBZ0IsdUJBQXVCLENBQUMscUNBQXFDLHVCQUF1QixDQUFDLHNCQUFzQix1QkFBdUIsQ0FBQyxrREFBa0QsdUJBQXVCLHVCQUF1QixDQUFDLHdCQUF3Qix1QkFBdUIsQ0FBQyxnQkFBZ0IscUJBQXFCLENBQUMsbUNBQW1DLGtCQUFrQixDQUFDLGlDQUFpQyxlQUFlLENBQUMsc0JBQXNCLGVBQWUsQ0FBQyxTQUFTLGtCQUFrQixDQUFDLGNBQWMsaUJBQWlCLGtCQUFrQixDQUFDLDJCQUEyQixrQkFBa0IsQ0FBQyxnREFBZ0QsbUJBQW1CLG1CQUFtQixXQUFXLENBQUMsZ0RBQWdELG9CQUFvQixnQkFBZ0IsQ0FBQyIsImZpbGUiOiJwcmludC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIjY29udGV4dC1iYXIsZGl2LnRvcC1tZW51LWJ1dHRvbnMsZGl2Lmdsb2JhbENvbW1lbnRzLGRpdi5jb21tZW50c1BhbmUsLnRiLXRpdGxlLWljb25zLCN0b3BiYXIsI3VzZXItbWVudXtwb3NpdGlvbjpyZWxhdGl2ZSAhaW1wb3J0YW50fSNoZWxwLW1lbnV7cG9zaXRpb246cmVsYXRpdmUgIWltcG9ydGFudH0jdG9wYmFye2Rpc3BsYXk6YmxvY2sgIWltcG9ydGFudDtoZWlnaHQ6YXV0byAhaW1wb3J0YW50fS50Yi1idXR0b257ZGlzcGxheTpub25lICFpbXBvcnRhbnR9LnRiLXRpdGxlLXdyYXBwZXJ7dGV4dC1hbGlnbjpsZWZ0ICFpbXBvcnRhbnQ7bWFyZ2luOjA7bGVmdDowO3doaXRlLXNwYWNlOmluaXRpYWw7cG9zaXRpb246cmVsYXRpdmV9LnRiLXRpdGxlLWxhbmd7ZGlzcGxheTpub25lICFpbXBvcnRhbnR9I292ZXJhbGxWaWV3e2xlZnQ6MCAhaW1wb3J0YW50fSNjb250ZW50e3Bvc2l0aW9uOnJlbGF0aXZlICFpbXBvcnRhbnQ7ZGlzcGxheTpibG9jayAhaW1wb3J0YW50O3RvcDowICFpbXBvcnRhbnQ7bGVmdDowICFpbXBvcnRhbnR9LmNvbW1hbmQtcHJvdmVuYW5jZXt2aXNpYmlsaXR5OnZpc2libGUgIWltcG9ydGFudDtvcGFjaXR5OjEgIWltcG9ydGFudH0jY29udGV4dC1iYXIsZGl2LnRvcC1tZW51LWJ1dHRvbnMsZGl2Lmdsb2JhbENvbW1lbnRzLGRpdi5jb21tZW50c1BhbmUsLnRiLXRpdGxlLWljb25zLCN0b29sdGlwLCNmaWxlYnJvd3Nlci1wb3B1cCwjc2VhcmNocGFuZWwtcG9wdXAsI3VzZXItbWVudXtkaXNwbGF5Om5vbmUgIWltcG9ydGFudH0uc3VibWl0LWhpbnQsYVtjbGFzcyo9XCItYnV0dG9uXCJdLGlbY2xhc3MqPVwiaWNvbi1cIl0sc2VsZWN0e2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fS5yZXN1bHRzIC5wbG90LWNvbnRyb2xze2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fWFbY2xhc3M9XCJjYW5jZWwtcXVlcnktYnV0dG9uXCJde2Rpc3BsYXk6YmxvY2sgIWltcG9ydGFudH0udGItc3RhdHVzLC50Yi1zdGF0dXMgaW1ne2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fS5jb21tYW5kLXJlc3VsdCAuc3Bpbm5lciAuc3Bpbm5lci13cmFwcGVye2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fWh0bWwsYm9keSwuc2hlbGxTZXNzaW9uVmlld3tvdmVyZmxvdzpoaWRkZW4gIWltcG9ydGFudH10ZXh0YXJlYTplbXB0eXtkaXNwbGF5Om5vbmUgIWltcG9ydGFudH1kaXYucHJpbWFyeVByb21wdHtkaXNwbGF5Om5vbmUgIWltcG9ydGFudH1kaXYuZGl2aWRlcntkaXNwbGF5Om5vbmUgIWltcG9ydGFudH0uY29tbWFuZHtib3JkZXI6bm9uZSAhaW1wb3J0YW50fSo6Oi13ZWJraXQtaW5wdXQtcGxhY2Vob2xkZXJ7Y29sb3I6dHJhbnBhcmVudH0qOi1tb3otcGxhY2Vob2xkZXJ7Y29sb3I6dHJhbnBhcmVudH0qOjotbW96LXBsYWNlaG9sZGVye2NvbG9yOnRyYW5wYXJlbnR9KjotbXMtaW5wdXQtcGxhY2Vob2xkZXJ7Y29sb3I6dHJhbnBhcmVudH0uZXhwYW5kaW5nVGV4dHttaW4taGVpZ2h0OmluaXRpYWwgIWltcG9ydGFudH0uY29tbWVudEZyYW1lIC5jb21tZW50LWxpc3QgbGl7bWFyZ2luOjB9LmNvbW1lbnRGcmFtZSAuaGVhZGVye2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fS5jb21tZW50RnJhbWUgLm5ldy1jb21tZW50e2JvcmRlci1ib3R0b206bm9uZSAhaW1wb3J0YW50fWRpdi5kaXZpZGVyOmhvdmVye2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fWRpdi5kaXZpZGVyOmhvdmVyIC5idG4tY2lyY2xle2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fS5jb21tYW5kOmhvdmVyLC5jb21tYW5kOmFjdGl2ZXtib3JkZXI6bm9uZSAhaW1wb3J0YW50O2JveC1zaGFkb3c6bm9uZSAhaW1wb3J0YW50fUBwYWdle21hcmdpbjoyY219Ym9keXttYXgtd2lkdGg6MTAwJSAhaW1wb3J0YW50fS51aS1yZXNpemFibGV7bWF4LWhlaWdodDoxMDAlO21heC13aWR0aDoxMDAlfS5maWd1cmUtcmVzdWx0cy1hbmQtY29tbWVudHMgLndpZGdldFtzdHlsZSo9XCJ3aWR0aDogYXV0bzsgaGVpZ2h0OiBhdXRvXCJde3dpZHRoOjEwMCUgIWltcG9ydGFudDttaW4taGVpZ2h0OjMwMHB4fS53aWRnZXQud2lkZ2V0LWlucHV0e21pbi1oZWlnaHQ6aW5pdGlhbCAhaW1wb3J0YW50fUAtbW96LWRvY3VtZW50IHVybC1wcmVmaXgoKXsudWktcmVzaXphYmxle3dpZHRoOmF1dG8gIWltcG9ydGFudDtoZWlnaHQ6YXV0byAhaW1wb3J0YW50O21heC13aWR0aDoxMDAlfX1pbWcsLmZpZ3VyZSwudWktcmVzaXplYWJsZXtwYWdlLWJyZWFrLWluc2lkZTphdm9pZH0ucHJldmlvdXNQcm9tcHR7cGFnZS1icmVhay1pbnNpZGU6YXZvaWR9LmNvbW1hbmQgLmNvbW1hbmQtaW5wdXQgLmNvbW1hbmQtYm94e3BhZ2UtYnJlYWstYmVmb3JlOmF2b2lkfS5yZXN1bHRzLWFuZC1jb21tZW50c3twYWdlLWJyZWFrLWJlZm9yZTphdm9pZH0ucmVzdWx0cy1hbmQtY29tbWVudHMuZmlndXJlLXJlc3VsdHMtYW5kLWNvbW1lbnRze3BhZ2UtYnJlYWstYmVmb3JlOmF1dG87cGFnZS1icmVhay1pbnNpZGU6YXZvaWR9LmNvbW1hbmQgLnVpLXJlc2l6ZWFibGV7cGFnZS1icmVhay1pbnNpZGU6YXZvaWR9LnRhYmxlLWJvcmRlcmVke2JvcmRlcjoxcHggc29saWQgI2RkZH0ucmVzdWx0cyAudGFibGUgdGhlYWQsLnRhYmxlIHRoZWFke2JhY2tncm91bmQ6I2ZhZmFmYX0uY29tbWFuZC1yZXN1bHQtd3JhcHBlciAucmVzdWx0c3tvdmVyZmxvdzpoaWRkZW59LnJlc3VsdHMtdGFibGUgLmlubmVye292ZXJmbG93OmhpZGRlbn0jY29udGVudHtvdmVyZmxvdy15OnZpc2libGV9LmNvbW1lbnRGcmFtZXtvdmVyZmxvdzp2aXNpYmxlO21hcmdpbi1ib3R0b206MjVweH0uY29tbWVudEZyYW1lIC5uZXctY29tbWVudHtib3JkZXItYm90dG9tOm5vbmV9LmNvbW1lbnRGcmFtZSAubWFpbiwuY29tbWVudEZyYW1lIC5jb21tZW50LWxpc3R7b3ZlcmZsb3cteTp2aXNpYmxlO21heC1oZWlnaHQ6aW5pdGlhbDtoZWlnaHQ6YXV0b30uc2Vzc2lvblBhbmUgLnNoZWxsLXRvcD5kaXY6bGFzdC1jaGlsZCAucmVzdWx0c3twYWRkaW5nLWJvdHRvbTo1MHB4O292ZXJmbG93OnZpc2libGV9Il19 */

</style>
<link rel="icon" type="image/png" href="data:image/png;base64,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">
<meta http-equiv="content-type" content="text/html; charset=UTF8">

</head>
<body>
<script>window.settings = {"dbcForumURL":"http://forums.databricks.com/","dbfsS3Host":"https://databricks-prod-storage-oregon.s3.amazonaws.com","enableThirdPartyApplicationsUI":false,"notebookRevisionVisibilityHorizon":0,"enableTableHandler":true,"isAdmin":false,"enablePresentationTimerConfig":true,"enableFullTextSearch":true,"enableNewSearchPanel":true,"enableElasticSparkUI":true,"clusters":false,"hideOffHeapCache":false,"applications":false,"fileStoreBase":"FileStore","configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo\\.registrator","valuePattern":".*","keyPatternDisplay":"spark.kryo.registrator","valuePatternDisplay":"*","description":"A user defined class that has serializer information"},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"}],"enableReactNotebookComments":true,"enableResetPassword":true,"sparkVersions":[{"key":"1.3.x","displayName":"Spark 1.3","packageLabel":"spark-1.3-jenkins-ip-10-2-0-138-Uce350f0a96-Sce350f0a96-2015-10-30-23:30:21.378521","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.4.x","displayName":"Spark 1.4","packageLabel":"spark-1.4-jenkins-ip-10-2-0-138-Uce350f0a96-Sce350f0a96-2015-10-30-23:30:21.378521","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x","displayName":"Spark 1.5","packageLabel":"spark-1.5-jenkins-ip-10-2-0-138-Uce350f0a96-Sce350f0a96-2015-10-30-23:30:21.378521","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"master","displayName":"Spark master (dev)","packageLabel":"","upgradable":true,"deprecated":false,"customerVisible":false}],"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","driverStdoutFilePrefix":"stdout","sparkHistoryServerEnabled":true,"enableIPythonImportExport":true,"enableNotebookHistoryDiffing":true,"branch":"2.5.5","local":false,"displayDefaultContainerMemoryGB":6,"enableIntercom":false,"useSpotForWorkers":false,"enableStaticNotebooks":true,"dbcGuideURL":"#workspace/databricks_guide/00 Welcome to Databricks","enableR":true,"orgId":0,"enableNotebookGitVersioning":true,"files":"files/","enableDriverLogsUI":true,"disableLegacyDashboards":false,"enableWorkspaceAclsConfig":true,"dropzoneMaxFileSize":4096,"driverLog4jFilePrefix":"log4j","enableMavenLibraries":true,"enableNewHelpMenu":true,"gitTimestamp":"2015-10-30 16:24:39 -0700","defaultSparkVersion":{"key":"1.5.x","displayName":"Spark 1.5","packageLabel":"spark-1.5-jenkins-ip-10-2-0-138-Uce350f0a96-Sce350f0a96-2015-10-30-23:30:21.378521","upgradable":true,"deprecated":false,"customerVisible":true},"staticNotebookCdnUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/","clusterPublisherRootId":5,"intercomAppId":"s67zdzhb","enableLatestJobRunResultPermalink":true,"enableSparkConfUI":true,"enableJdbcImport":true,"logfiles":"logfiles/","enableClusterDeltaUpdates":true,"csrfToken":"ddbb3f6b-7e4c-498b-8ccd-855e2ab302fc","useFixedStaticNotebookVersionForDevelopment":false,"enableBasicReactDialogBoxes":true,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"http://feedback.databricks.com/forums/263785-product-feedback","enableWorkspaceAclService":true,"enableWorkspaceAcls":true,"gitHash":"ce350f0a9622b7b742da5cf8d5cb0e2b75e1c4c7-dirty","enableLibraryUI":true,"userFullname":"Alex Zeltov","enableMiniClusters":false,"enableWebSocketDeltaUpdates":true,"enableDebugUI":false,"showHiddenSparkVersions":false,"allowNonAdminUsers":true,"userId":100006,"dbcSupportURL":"","enableSparkPackages":true,"enableNotebookHistoryUI":true,"enableSparkVersionsUI":true,"notebookLoadingBackground":"#fff","enableNewJobRunDetailsPage":true,"enableDashboardExport":true,"user":"azeltov@hortonworks.com","enableServerAutoComplete":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"tablesPublisherRootId":7,"accounts":false,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"defaultZoneId":"us-west-2c"};</script>

<script>var notebookModelJson = {"clusterMemory":0,"name":"GraphX Demo","path":"/1/3561/8446/8491","guid":"7ab5a91b-be74-419f-9b73-eca90ccdb778","jsRunAllAction":"NoAction","iPythonMetadata":null,"runStatus":"idle","clusterId":"","id":8491,"language":"scala","deltaVersion":712278,"targetClusterId":null,"deltaEvent":"update","type":"shell","clusterName":"","parentId":3625,"globalVars":{},"latestUser":"admin@databricks.com","permissionLevel":"Can Read"};</script>

<script>var notebookModelCommandCollection = [{"type":"command","id":8493,"parentId":8491,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"078aeae7-75b3-402c-acca-e9531bd78015","subtype":"command","commandType":"auto","position":0.5,"command":"%md #GraphX Demonstration","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1439393224451,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"bmc@ardentex.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"c11a0196-0e97-4596-ba08-21f768cfb795","globalVars":{},"iPythonMetadata":null,"path":"/3625/8491/8493","arguments":{},"parent":null,"localVersion":3,"presenceMarks":[],"clusterId":"","clusterName":"","clusterMemory":0,"comments":null},{"type":"command","id":8494,"parentId":8491,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"945cc344-4e3f-4dc6-9b52-9b22ec8a22c7","subtype":"command","commandType":"auto","position":0.5625,"command":"%md ## What is GraphX?\n\n[GraphX](http://spark.apache.org/docs/latest/graphx-programming-guide.html#the-property-graph) is an API that allows you to analyze graph data (social graphs, network graphs, and the like) using the power of the Spark cluster.\n\nThis notebook contains a simple demonstration of just one small part of the GraphX API. It's designed to give you a bird's eye view of GraphX. Hopefully, it'll whet your appetite.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1439408489010,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"bmc@ardentex.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"ebb91765-bee0-4420-b6a2-2382a6e49d0a","globalVars":{},"iPythonMetadata":null,"path":"/3625/8491/8494","arguments":{},"parent":null,"localVersion":3,"presenceMarks":[],"clusterId":"","clusterName":"","clusterMemory":0,"comments":null},{"type":"command","id":8495,"parentId":8491,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"e186b064-4096-4490-a0ad-6b65047281ad","subtype":"command","commandType":"auto","position":0.59375,"command":"%md ## Resources\n\n* [Manning](http://www.manning.com/) has an early-access (MEAP) [_Spark GraphX in Action_](http://www.manning.com/malak/) book.\n* The [GraphX Programming Guide](http://spark.apache.org/docs/latest/graphx-programming-guide.html#the-property-graph) is a good place to start.\n* The paper \"[GraphX: A Resilient Distributed Graph System on Spark](https://amplab.cs.berkeley.edu/wp-content/uploads/2013/05/grades-graphx_with_fonts.pdf)\" is worth reading.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1439408721231,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"bmc@ardentex.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"f0e4e00f-c102-487f-8312-cbde55eef672","globalVars":{},"iPythonMetadata":null,"path":"/3625/8491/8495","arguments":{},"parent":null,"localVersion":3,"presenceMarks":[],"clusterId":"","clusterName":"","clusterMemory":0,"comments":null},{"type":"command","id":8496,"parentId":8491,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"a0e9dfe2-db04-4940-abda-87f093d7e495","subtype":"command","commandType":"auto","position":0.625,"command":"%md A variant of this demonstration, with a detailed explanation, can be found here: <http://ampcamp.berkeley.edu/big-data-mini-course/graph-analytics-with-graphx.html>","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1439408305604,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"bmc@ardentex.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"32377ce2-e5b0-4209-8200-4315315704b4","globalVars":{},"iPythonMetadata":null,"path":"/3625/8491/8496","arguments":{},"parent":null,"localVersion":3,"presenceMarks":[],"clusterId":"","clusterName":"","clusterMemory":0,"comments":null},{"type":"command","id":8497,"parentId":8491,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"bb97ddcf-503d-489f-a08c-8dc15357338e","subtype":"command","commandType":"auto","position":0.75,"command":"%md The following example creates a _property graph_. (See <http://spark.apache.org/docs/latest/graphx-programming-guide.html#the-property-graph>) Let's assume we're dealing with the relationship (or _level of interest_) graph for a dating site. Let's create a graph of some of the participants and their interest levels in one another.\n\nHere's an example of a property graph:\n\n![Property Graph Example](http://i.imgur.com/C4FPxXV.png)\n\n","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1439486861516,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"bmc@ardentex.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"36f82707-3ffe-4bbb-86cd-2e7a3bc0fb14","globalVars":{},"iPythonMetadata":null,"path":"/3625/8491/8497","arguments":{},"parent":null,"localVersion":3,"presenceMarks":[],"clusterId":"","clusterName":"","clusterMemory":0,"comments":null},{"type":"command","id":8498,"parentId":8491,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"d3299868-9393-4c05-8737-721857e051ed","subtype":"command","commandType":"auto","position":1,"command":"import org.apache.spark.graphx._  // Edge comes from here\nimport org.apache.spark.rdd.RDD\n\ncase class Person(id: Int, name: String, age: Int)\n\ntype VertexType = Tuple2[Long, Person]\n\nval vertexArray = Array[VertexType](\n  /* Index number, Person */\n  (1L, Person(1, \"Angelica\", 23)), // Tuple2[Long, Person] or VertexType\n  (2L, Person(2, \"Valentino\", 31)),\n  (3L, Person(3, \"Mercedes\", 52)),\n  (4L, Person(4, \"Anthony\", 39)),\n  (5L, Person(5, \"Roberto\", 45))\n)\n\nval edgeArray = Array(\n  /* First Person by Index >> related somehow to Second Person by Index, with Attribute Value (which is contextual) */\n  Edge(2L, 1L, 9), // Valentino (source) is highly attracted to Angelica (target) (7 stars out of 10)\n  Edge(2L, 4L, 2), // Valentino is not really interested in Anthony (only 2 stars)\n  Edge(3L, 2L, 8), // Mercedes is EXTREMELY interested in Valentino (8 stars!)\n  Edge(3L, 5L, 3), // Mercedes is not all that interested in Roberto (3 stars)\n  Edge(4L, 1L, 1), // Anthony isn't the least bit interested in Angelica, but gave her 1 star anyway (not to hurt her feelings) ...\n  Edge(5L, 3L, 5), // Roberto is ambivalent whether he's interested in Mercedes (5/10 stars)\n  Edge(5L, 1L, 7), // Roberto is attracted to Angelica\n  Edge(1L, 2L, 9), // Angelica is highly attracted to Valentino\n  Edge(4L, 3L, 0)  // Anthony can't stand Mercedes\n  \n)\n\n// Vertices are NODES on the (social) graph\nval vertexRDD: RDD[VertexType] = sc.parallelize(vertexArray)\n\n// Edges are \"arrows\" direction (going from one node towards another node)\nval edgeRDD: RDD[Edge[Int]] = sc.parallelize(edgeArray)\n\nval g: Graph[Person, Int] = Graph(vertexRDD, edgeRDD)\n\nval results = g.triplets.filter(t => t.attr >= 8).filter(t => t.srcAttr.age > 40)\n\nfor (triplet <- results.collect) {\n  println(s\"*** ${triplet.srcAttr.name} is extremely attracted to ${triplet.dstAttr.name} \\n\")\n}\n","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1439490174946,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"bmc@ardentex.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"dc535c28-113b-4853-9f08-61d124cca06a","globalVars":{},"iPythonMetadata":null,"path":"/3625/8491/8498","parent":null,"localVersion":3,"presenceMarks":[],"clusterId":"","clusterName":"","clusterMemory":0,"comments":null},{"type":"command","id":8499,"parentId":8491,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"7c00b504-266b-4bbd-98bf-22cc56ca73c5","subtype":"command","commandType":"auto","position":2,"command":"for (t <- g.triplets.collect()) { //Collection of Vertex >> Edge >> Vertex ... walking the Graph here.\n  // We're looking at one (vertex, edge, vertex) triplet here.\n  t.attr match { // match on rating, for each element in the Graph assign a value to t\n    case n if (n > 8)  => println(s\"${t.srcAttr.name} is in love with ${t.dstAttr.name}: $n stars\")\n    case n if (n > 6)  => println(s\"${t.srcAttr.name} is attracted to ${t.dstAttr.name}: $n stars\")\n    case n if (n > 3)  => println(s\"${t.srcAttr.name} is ambivalent about ${t.dstAttr.name}: $n stars\" )\n    case n if (n > 1)  => println(s\"${t.srcAttr.name} is not attracted to ${t.dstAttr.name}: $n stars\")\n    case n if (n == 1) => println(s\"${t.srcAttr.name} is not attracted to ${t.dstAttr.name}: 1 star\")\n    case _             => println(s\"${t.srcAttr.name} can't stand ${t.dstAttr.name}: NO STARS\")\n  }\n}\nprintln()","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1439490177516,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"bmc@ardentex.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"55552eee-fccd-443e-a5ca-2ed2a4c770b6","globalVars":{},"iPythonMetadata":null,"path":"/3625/8491/8499","parent":null,"localVersion":3,"presenceMarks":[],"clusterId":"","clusterName":"","clusterMemory":0,"comments":null},{"type":"command","id":8500,"parentId":8491,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"a6809d7f-c48e-4ee6-9967-b6b63ae7a031","subtype":"command","commandType":"auto","position":2.5,"command":"%md We can visually scan the output to find people who are in love with each other, but only because the graph is so small. In a larger graph, that would be tedious. So, let's see if we can find process the graph programmatically to find people who are in love. We'll define \"in love\" as two people who have rated each with more than 8 stars.\n\nThis is a little complicated. (There may well be a better way to do this.)","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1439490178946,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"bmc@ardentex.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"08e83d73-47ad-43cc-b68e-091e2da2fcc8","globalVars":{},"iPythonMetadata":null,"path":"/3625/8491/8500","arguments":{},"parent":null,"localVersion":3,"presenceMarks":[],"clusterId":"","clusterName":"","clusterMemory":0,"comments":null},{"type":"command","id":8501,"parentId":8491,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"58f88dcf-2c50-49d1-a2f8-23086fd95323","subtype":"command","commandType":"auto","position":3,"command":"// First, get the graph's triplets. (Recall: Each trip is a pair of vertices\n// and the edge that connects them.)\n\nval rdd1 = g.triplets\n            // Get rid of any pair with a score of 8 or lower.\n            .filter { t => t.attr > 8 }\n            // Map each triplet into into a (unique-key, (person, person))\n            // tuple. We need the unique key, because cogroup() wants a\n            // key/value pair for cogroup().\n            .map { t =>\n              val pair = (t.srcAttr, t.dstAttr)\n              (pair.hashCode, pair)\n            }\n\n// Now, create a second RDD which is a mirror of this RDD (i.e., with the\n// people in each pair flipped). We can then join the two RDDs using cogroup(),\n// to find pairs where (person1 likes person2) AND (person2 likes person1).\n//\n// For example, suppose we have:\n//   [ (Joe, Rita),\n//     (Rita, Joe),\n//     (Jamie, Bill) ]\n//\n// We want to detect that (Joe likes Rita) AND (Rita likes Joe).\n// To do that, we can create a second RDD that looks like this:\n//\n//   [ (Rita, Joe),\n//     (Joe, Rita),\n//     (Bill, Jamie) ]\n//\n// Then, we can use cogroup() to match them up.\nval rdd2 = rdd1.map { case (hash, (p1, p2)) => (hash, (p2, p1)) }\n\n// Use cogroup() to join the two RDDs.\nval joined = rdd1.cogroup(rdd2)\n\n// The joined RDD consists of the unique ID, a left iterable and a right iterable.\n// Just looping over one of the iterables is good enough for our purposes. Note that\n// we'll get two hits for each pair.\nfor { (hash, (leftIterable, rightIterable)) <- joined.collect\n      (person1, person2)                    <- leftIterable }\n  println(s\"${person1.name} \\u2661 ${person2.name}\")\n","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1439490179976,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"bmc@ardentex.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"bed853c4-15b5-4dee-a3f8-d4e2065bb924","globalVars":{},"iPythonMetadata":null,"path":"/3625/8491/8501","parent":null,"localVersion":3,"presenceMarks":[],"clusterId":"","clusterName":"","clusterMemory":0,"comments":null},{"type":"command","id":8502,"parentId":8491,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"03e25770-b9a1-4019-87a1-9f41bb83687b","subtype":"command","commandType":"auto","position":3.5,"command":"%md If `cogroup()` is confusing, you can use DataFrames.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1439490182599,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"bmc@ardentex.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"7162dc9a-f0c3-4bcb-b0da-3484880913fc","globalVars":{},"iPythonMetadata":null,"path":"/3625/8491/8502","arguments":{},"parent":null,"localVersion":3,"presenceMarks":[],"clusterId":"","clusterName":"","clusterMemory":0,"comments":null},{"type":"command","id":8503,"parentId":8491,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"1750b606-193c-4ea5-af28-3d20ac6577a0","subtype":"command","commandType":"auto","position":3.75,"command":"val df = rdd1.toDF(\"id\", \"pair\")\ndf.printSchema()\n","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1439490184423,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"bmc@ardentex.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"5e37e286-64b7-4a0c-a009-6fb0fbfd1cfa","globalVars":{},"iPythonMetadata":null,"path":"/3625/8491/8503","parent":null,"localVersion":3,"presenceMarks":[],"clusterId":"","clusterName":"","clusterMemory":0,"comments":null},{"type":"command","id":8504,"parentId":8491,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"741d981f-3209-4fc9-b05c-ad5c212ea048","subtype":"command","commandType":"auto","position":3.875,"command":"%md Let's do a self-join. We'll create two separate derived DataFrames with renamed columns.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1439490186157,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"bmc@ardentex.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"09d31ad2-a04e-4001-b856-6342c70d8c42","globalVars":{},"iPythonMetadata":null,"path":"/3625/8491/8504","arguments":{},"parent":null,"localVersion":3,"presenceMarks":[],"clusterId":"","clusterName":"","clusterMemory":0,"comments":null},{"type":"command","id":8505,"parentId":8491,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"7dca2ab1-6661-48a4-907c-fb05c71d6aee","subtype":"command","commandType":"auto","position":3.9375,"command":"val dfA = df.select($\"pair\".as(\"pair1\"))\nval dfB = df.select($\"pair\".as(\"pair2\"))\ndfA.show()\ndfB.show()\n","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1439490187203,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"bmc@ardentex.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"de6b3593-a0af-404b-981a-8816aa155a43","globalVars":{},"iPythonMetadata":null,"path":"/3625/8491/8505","parent":null,"localVersion":3,"presenceMarks":[],"clusterId":"","clusterName":"","clusterMemory":0,"comments":null},{"type":"command","id":8506,"parentId":8491,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"11ec51ab-7387-4600-8ea3-36854086156c","subtype":"command","commandType":"auto","position":3.96875,"command":"%md Perfect! Now we can do a simple DataFrame join.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1439490189871,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"bmc@ardentex.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"4aaa83eb-5f47-419e-bbf7-501a6bc85637","globalVars":{},"iPythonMetadata":null,"path":"/3625/8491/8506","arguments":{},"parent":null,"localVersion":3,"presenceMarks":[],"clusterId":"","clusterName":"","clusterMemory":0,"comments":null},{"type":"command","id":8507,"parentId":8491,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"9c3747a2-ea90-4944-b60c-ac63a013580c","subtype":"command","commandType":"auto","position":3.984375,"command":"dfA.join(dfB, $\"pair1._1.id\" === $\"pair2._2.id\").select($\"pair1._1.name\", $\"pair1._2.name\").collect().foreach { row =>\n  val name1 = row(0)\n  val name2 = row(1)\n  println(s\"$name1 \\u2661 $name2\")\n}","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1439490217528,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"bmc@ardentex.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"fa5ced2c-c128-4e77-99d7-c9d25a7bee85","globalVars":{},"iPythonMetadata":null,"path":"/3625/8491/8507","parent":null,"localVersion":3,"presenceMarks":[],"clusterId":"","clusterName":"","clusterMemory":0,"comments":null},{"type":"command","id":8508,"parentId":8491,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"b2f2b404-ddfe-4e24-a264-16536d171062","subtype":"command","commandType":"auto","position":4,"command":"%md Either way...\n# We have achieved mutual compatibility\n![Angelica](http://i.imgur.com/JtUvZfC.jpg) ![Heart](http://i.imgur.com/9kNn5lK.png) ![Valentino](http://i.imgur.com/ZBB8Hlr.jpg)","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1439396078714,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"bmc@ardentex.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"284f66f1-20e7-4585-bb00-6ccd0ece0b5a","globalVars":{},"iPythonMetadata":null,"path":"/3625/8491/8508","arguments":{},"parent":null,"localVersion":3,"presenceMarks":[],"clusterId":"","clusterName":"","clusterMemory":0,"comments":null},{"type":"dashboardV2","id":8492,"parentId":8491,"defaultSize":{"width":1024,"height":768},"guid":"8fdd85b9-8f5b-4f16-8057-be3291460c83","globalVars":{},"path":"/3625/8491/8492","parent":null,"nuid":"c812b305-ac8b-4327-b92f-ee15974dcc5a"}];</script>

<script>
var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/201510301624390700-ce350f0a9622b7b742da5cf8d5cb0e2b75e1c4c7-dirty/notebook-main.js';
var s = document.createElement('script');
var b = document.getElementsByTagName('body')[0];
b.appendChild(s);
s.onerror = function() {
  var c = document.createElement('div');
  c.innerHTML = '<h1>Network Error</h1><p><b>Please check your network connection and try again.</b></p><p>Could not load a required resource: ' + u + '</p>';
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
};
s.src = u;
</script>
</body>
</html>