<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<title>Power-Lab3-ML - Databricks</title>
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">
<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
<link rel='stylesheet' type='text/css' href='https://databricks-prod-cloudfront.cloud.databricks.com/static/201510301624390700-ce350f0a9622b7b742da5cf8d5cb0e2b75e1c4c7-dirty/notebook.css'></style>
<style media='print'>
#context-bar,div.top-menu-buttons,div.globalComments,div.commentsPane,.tb-title-icons,#topbar,#user-menu{position:relative !important}#help-menu{position:relative !important}#topbar{display:block !important;height:auto !important}.tb-button{display:none !important}.tb-title-wrapper{text-align:left !important;margin:0;left:0;white-space:initial;position:relative}.tb-title-lang{display:none !important}#overallView{left:0 !important}#content{position:relative !important;display:block !important;top:0 !important;left:0 !important}.command-provenance{visibility:visible !important;opacity:1 !important}#context-bar,div.top-menu-buttons,div.globalComments,div.commentsPane,.tb-title-icons,#tooltip,#filebrowser-popup,#searchpanel-popup,#user-menu{display:none !important}.submit-hint,a[class*="-button"],i[class*="icon-"],select{display:none !important}.results .plot-controls{display:none !important}a[class="cancel-query-button"]{display:block !important}.tb-status,.tb-status img{display:none !important}.command-result .spinner .spinner-wrapper{display:none !important}html,body,.shellSessionView{overflow:hidden !important}textarea:empty{display:none !important}div.primaryPrompt{display:none !important}div.divider{display:none !important}.command{border:none !important}*::-webkit-input-placeholder{color:tranparent}*:-moz-placeholder{color:tranparent}*::-moz-placeholder{color:tranparent}*:-ms-input-placeholder{color:tranparent}.expandingText{min-height:initial !important}.commentFrame .comment-list li{margin:0}.commentFrame .header{display:none !important}.commentFrame .new-comment{border-bottom:none !important}div.divider:hover{display:none !important}div.divider:hover .btn-circle{display:none !important}.command:hover,.command:active{border:none !important;box-shadow:none !important}@page{margin:2cm}body{max-width:100% !important}.ui-resizable{max-height:100%;max-width:100%}.figure-results-and-comments .widget[style*="width: auto; height: auto"]{width:100% !important;min-height:300px}.widget.widget-input{min-height:initial !important}@-moz-document url-prefix(){.ui-resizable{width:auto !important;height:auto !important;max-width:100%}}img,.figure,.ui-resizeable{page-break-inside:avoid}.previousPrompt{page-break-inside:avoid}.command .command-input .command-box{page-break-before:avoid}.results-and-comments{page-break-before:avoid}.results-and-comments.figure-results-and-comments{page-break-before:auto;page-break-inside:avoid}.command .ui-resizeable{page-break-inside:avoid}.table-bordered{border:1px solid #ddd}.results .table thead,.table thead{background:#fafafa}.command-result-wrapper .results{overflow:hidden}.results-table .inner{overflow:hidden}#content{overflow-y:visible}.commentFrame{overflow:visible;margin-bottom:25px}.commentFrame .new-comment{border-bottom:none}.commentFrame .main,.commentFrame .comment-list{overflow-y:visible;max-height:initial;height:auto}.sessionPane .shell-top>div:last-child .results{padding-bottom:50px;overflow:visible}
/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByaW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSx5R0FBeUcsNEJBQTRCLENBQUMsV0FBVyw0QkFBNEIsQ0FBQyxRQUFRLHlCQUF5QixzQkFBc0IsQ0FBQyxXQUFXLHVCQUF1QixDQUFDLGtCQUFrQiwyQkFBMkIsU0FBUyxPQUFPLG9CQUFvQixpQkFBaUIsQ0FBQyxlQUFlLHVCQUF1QixDQUFDLGFBQWEsaUJBQWlCLENBQUMsU0FBUyw2QkFBNkIseUJBQXlCLGlCQUFpQixpQkFBaUIsQ0FBQyxvQkFBb0IsOEJBQThCLG9CQUFvQixDQUFDLGdKQUFnSix1QkFBdUIsQ0FBQywwREFBMEQsdUJBQXVCLENBQUMsd0JBQXdCLHVCQUF1QixDQUFDLCtCQUErQix3QkFBd0IsQ0FBQywwQkFBMEIsdUJBQXVCLENBQUMsMENBQTBDLHVCQUF1QixDQUFDLDRCQUE0QiwwQkFBMEIsQ0FBQyxlQUFlLHVCQUF1QixDQUFDLGtCQUFrQix1QkFBdUIsQ0FBQyxZQUFZLHVCQUF1QixDQUFDLFNBQVMsc0JBQXNCLENBQUMsNkJBQTZCLGdCQUFnQixDQUFDLG1CQUFtQixnQkFBZ0IsQ0FBQyxvQkFBb0IsZ0JBQWdCLENBQUMsd0JBQXdCLGdCQUFnQixDQUFDLGVBQWUsNkJBQTZCLENBQUMsK0JBQStCLFFBQVEsQ0FBQyxzQkFBc0IsdUJBQXVCLENBQUMsMkJBQTJCLDZCQUE2QixDQUFDLGtCQUFrQix1QkFBdUIsQ0FBQyw4QkFBOEIsdUJBQXVCLENBQUMsK0JBQStCLHVCQUF1QiwwQkFBMEIsQ0FBQyxNQUFNLFVBQVUsQ0FBQyxLQUFLLHlCQUF5QixDQUFDLGNBQWMsZ0JBQWdCLGNBQWMsQ0FBQyx5RUFBeUUsc0JBQXNCLGdCQUFnQixDQUFDLHFCQUFxQiw2QkFBNkIsQ0FBQyw0QkFBNEIsY0FBYyxzQkFBc0IsdUJBQXVCLGNBQWMsQ0FBQyxDQUFDLDJCQUEyQix1QkFBdUIsQ0FBQyxnQkFBZ0IsdUJBQXVCLENBQUMscUNBQXFDLHVCQUF1QixDQUFDLHNCQUFzQix1QkFBdUIsQ0FBQyxrREFBa0QsdUJBQXVCLHVCQUF1QixDQUFDLHdCQUF3Qix1QkFBdUIsQ0FBQyxnQkFBZ0IscUJBQXFCLENBQUMsbUNBQW1DLGtCQUFrQixDQUFDLGlDQUFpQyxlQUFlLENBQUMsc0JBQXNCLGVBQWUsQ0FBQyxTQUFTLGtCQUFrQixDQUFDLGNBQWMsaUJBQWlCLGtCQUFrQixDQUFDLDJCQUEyQixrQkFBa0IsQ0FBQyxnREFBZ0QsbUJBQW1CLG1CQUFtQixXQUFXLENBQUMsZ0RBQWdELG9CQUFvQixnQkFBZ0IsQ0FBQyIsImZpbGUiOiJwcmludC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIjY29udGV4dC1iYXIsZGl2LnRvcC1tZW51LWJ1dHRvbnMsZGl2Lmdsb2JhbENvbW1lbnRzLGRpdi5jb21tZW50c1BhbmUsLnRiLXRpdGxlLWljb25zLCN0b3BiYXIsI3VzZXItbWVudXtwb3NpdGlvbjpyZWxhdGl2ZSAhaW1wb3J0YW50fSNoZWxwLW1lbnV7cG9zaXRpb246cmVsYXRpdmUgIWltcG9ydGFudH0jdG9wYmFye2Rpc3BsYXk6YmxvY2sgIWltcG9ydGFudDtoZWlnaHQ6YXV0byAhaW1wb3J0YW50fS50Yi1idXR0b257ZGlzcGxheTpub25lICFpbXBvcnRhbnR9LnRiLXRpdGxlLXdyYXBwZXJ7dGV4dC1hbGlnbjpsZWZ0ICFpbXBvcnRhbnQ7bWFyZ2luOjA7bGVmdDowO3doaXRlLXNwYWNlOmluaXRpYWw7cG9zaXRpb246cmVsYXRpdmV9LnRiLXRpdGxlLWxhbmd7ZGlzcGxheTpub25lICFpbXBvcnRhbnR9I292ZXJhbGxWaWV3e2xlZnQ6MCAhaW1wb3J0YW50fSNjb250ZW50e3Bvc2l0aW9uOnJlbGF0aXZlICFpbXBvcnRhbnQ7ZGlzcGxheTpibG9jayAhaW1wb3J0YW50O3RvcDowICFpbXBvcnRhbnQ7bGVmdDowICFpbXBvcnRhbnR9LmNvbW1hbmQtcHJvdmVuYW5jZXt2aXNpYmlsaXR5OnZpc2libGUgIWltcG9ydGFudDtvcGFjaXR5OjEgIWltcG9ydGFudH0jY29udGV4dC1iYXIsZGl2LnRvcC1tZW51LWJ1dHRvbnMsZGl2Lmdsb2JhbENvbW1lbnRzLGRpdi5jb21tZW50c1BhbmUsLnRiLXRpdGxlLWljb25zLCN0b29sdGlwLCNmaWxlYnJvd3Nlci1wb3B1cCwjc2VhcmNocGFuZWwtcG9wdXAsI3VzZXItbWVudXtkaXNwbGF5Om5vbmUgIWltcG9ydGFudH0uc3VibWl0LWhpbnQsYVtjbGFzcyo9XCItYnV0dG9uXCJdLGlbY2xhc3MqPVwiaWNvbi1cIl0sc2VsZWN0e2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fS5yZXN1bHRzIC5wbG90LWNvbnRyb2xze2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fWFbY2xhc3M9XCJjYW5jZWwtcXVlcnktYnV0dG9uXCJde2Rpc3BsYXk6YmxvY2sgIWltcG9ydGFudH0udGItc3RhdHVzLC50Yi1zdGF0dXMgaW1ne2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fS5jb21tYW5kLXJlc3VsdCAuc3Bpbm5lciAuc3Bpbm5lci13cmFwcGVye2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fWh0bWwsYm9keSwuc2hlbGxTZXNzaW9uVmlld3tvdmVyZmxvdzpoaWRkZW4gIWltcG9ydGFudH10ZXh0YXJlYTplbXB0eXtkaXNwbGF5Om5vbmUgIWltcG9ydGFudH1kaXYucHJpbWFyeVByb21wdHtkaXNwbGF5Om5vbmUgIWltcG9ydGFudH1kaXYuZGl2aWRlcntkaXNwbGF5Om5vbmUgIWltcG9ydGFudH0uY29tbWFuZHtib3JkZXI6bm9uZSAhaW1wb3J0YW50fSo6Oi13ZWJraXQtaW5wdXQtcGxhY2Vob2xkZXJ7Y29sb3I6dHJhbnBhcmVudH0qOi1tb3otcGxhY2Vob2xkZXJ7Y29sb3I6dHJhbnBhcmVudH0qOjotbW96LXBsYWNlaG9sZGVye2NvbG9yOnRyYW5wYXJlbnR9KjotbXMtaW5wdXQtcGxhY2Vob2xkZXJ7Y29sb3I6dHJhbnBhcmVudH0uZXhwYW5kaW5nVGV4dHttaW4taGVpZ2h0OmluaXRpYWwgIWltcG9ydGFudH0uY29tbWVudEZyYW1lIC5jb21tZW50LWxpc3QgbGl7bWFyZ2luOjB9LmNvbW1lbnRGcmFtZSAuaGVhZGVye2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fS5jb21tZW50RnJhbWUgLm5ldy1jb21tZW50e2JvcmRlci1ib3R0b206bm9uZSAhaW1wb3J0YW50fWRpdi5kaXZpZGVyOmhvdmVye2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fWRpdi5kaXZpZGVyOmhvdmVyIC5idG4tY2lyY2xle2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fS5jb21tYW5kOmhvdmVyLC5jb21tYW5kOmFjdGl2ZXtib3JkZXI6bm9uZSAhaW1wb3J0YW50O2JveC1zaGFkb3c6bm9uZSAhaW1wb3J0YW50fUBwYWdle21hcmdpbjoyY219Ym9keXttYXgtd2lkdGg6MTAwJSAhaW1wb3J0YW50fS51aS1yZXNpemFibGV7bWF4LWhlaWdodDoxMDAlO21heC13aWR0aDoxMDAlfS5maWd1cmUtcmVzdWx0cy1hbmQtY29tbWVudHMgLndpZGdldFtzdHlsZSo9XCJ3aWR0aDogYXV0bzsgaGVpZ2h0OiBhdXRvXCJde3dpZHRoOjEwMCUgIWltcG9ydGFudDttaW4taGVpZ2h0OjMwMHB4fS53aWRnZXQud2lkZ2V0LWlucHV0e21pbi1oZWlnaHQ6aW5pdGlhbCAhaW1wb3J0YW50fUAtbW96LWRvY3VtZW50IHVybC1wcmVmaXgoKXsudWktcmVzaXphYmxle3dpZHRoOmF1dG8gIWltcG9ydGFudDtoZWlnaHQ6YXV0byAhaW1wb3J0YW50O21heC13aWR0aDoxMDAlfX1pbWcsLmZpZ3VyZSwudWktcmVzaXplYWJsZXtwYWdlLWJyZWFrLWluc2lkZTphdm9pZH0ucHJldmlvdXNQcm9tcHR7cGFnZS1icmVhay1pbnNpZGU6YXZvaWR9LmNvbW1hbmQgLmNvbW1hbmQtaW5wdXQgLmNvbW1hbmQtYm94e3BhZ2UtYnJlYWstYmVmb3JlOmF2b2lkfS5yZXN1bHRzLWFuZC1jb21tZW50c3twYWdlLWJyZWFrLWJlZm9yZTphdm9pZH0ucmVzdWx0cy1hbmQtY29tbWVudHMuZmlndXJlLXJlc3VsdHMtYW5kLWNvbW1lbnRze3BhZ2UtYnJlYWstYmVmb3JlOmF1dG87cGFnZS1icmVhay1pbnNpZGU6YXZvaWR9LmNvbW1hbmQgLnVpLXJlc2l6ZWFibGV7cGFnZS1icmVhay1pbnNpZGU6YXZvaWR9LnRhYmxlLWJvcmRlcmVke2JvcmRlcjoxcHggc29saWQgI2RkZH0ucmVzdWx0cyAudGFibGUgdGhlYWQsLnRhYmxlIHRoZWFke2JhY2tncm91bmQ6I2ZhZmFmYX0uY29tbWFuZC1yZXN1bHQtd3JhcHBlciAucmVzdWx0c3tvdmVyZmxvdzpoaWRkZW59LnJlc3VsdHMtdGFibGUgLmlubmVye292ZXJmbG93OmhpZGRlbn0jY29udGVudHtvdmVyZmxvdy15OnZpc2libGV9LmNvbW1lbnRGcmFtZXtvdmVyZmxvdzp2aXNpYmxlO21hcmdpbi1ib3R0b206MjVweH0uY29tbWVudEZyYW1lIC5uZXctY29tbWVudHtib3JkZXItYm90dG9tOm5vbmV9LmNvbW1lbnRGcmFtZSAubWFpbiwuY29tbWVudEZyYW1lIC5jb21tZW50LWxpc3R7b3ZlcmZsb3cteTp2aXNpYmxlO21heC1oZWlnaHQ6aW5pdGlhbDtoZWlnaHQ6YXV0b30uc2Vzc2lvblBhbmUgLnNoZWxsLXRvcD5kaXY6bGFzdC1jaGlsZCAucmVzdWx0c3twYWRkaW5nLWJvdHRvbTo1MHB4O292ZXJmbG93OnZpc2libGV9Il19 */

</style>
<link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAJPUlEQVR4XuVbW2wcZxU+/9x3vXfHu+vEsQmxQ1QqFEDUcQhqKm4SSBSpLyU1L0RCqAiEgEpNQtPcaOgDUAkBAoIEVdsUiZeKSoiHKlWokpgiWokWROwkxG5sr73369x/dMaexXbWuzM7YyeG82R5/ss533/2P9/5dpbA/7mRuxX/zUPvk2Kq/CQDJs0LwWd3vf5v+W74sukAYOAJXf6FGJYeEwMsi0ErDcOQK/LzBU56fLOB2DQA6CHgylr6J2KMOyKKIt/qtBVF0ZSi+ssIv/At8jrom5ERGw4ABWBKH08/K0a5b0iSKDoJSpYVRSlqz0UvZ44RANPJnG7HbCgAhbH0KTEsPBEI8YFuHGxUtYZWkc9Fryyc6Wa+kzkbAkBxLPldISo9HQjyISdOdBrTqGtVpaQ8Fb+Sea7TWLfPfQUgvz/5tWCUOyf2BGJuHXEyXqk1inLJeCJ2NXPeyXgnY3wBID+aHA9ExB9LYWGbk029jpErSrZRlb+ZuJK94HUtTwAUxpJfFHu4nwcigbRXR7qZ3yg35uWq+tXE1ewfupmPc7oCIDea/LQg8edDvdJgtxv7Oa+ak6eNuv6V2JuZ19yu6wqA3FjygBTgng9GA7u7g86tey7GU4B6qTYl1+iXeycyV53OdARA4WN9+4Qg/2IgId1HiKMpTvf3fRylFOp5+V2tro3H31x8u9MGbaNZfGDbHiHI/i4c69lHmHs78LWBUpNCrSD/TW6oX+r7S/baekC0jKpwoH+I48jLwbi0n2G3VuBrAzUNCvVi47KuweH45blba5+vii4zmkwFBPZlKSE9yLNb7Mg75LpmmFQuKBcbin44NbGQsYc3ASgfTL8qJgKfE7j/rcDX4qLqJlXyjVcjb8x/YVUZvLUrSBODUQj1BjvdG1v6eTVbh/xMCYZu1q3Db2bAZJqn+A+xR4DeoRgEY9KWDnSt8/VCA3LTJVBqqvVoZF5rDYA9MRARoXcwBlLEUQd7z4LVKCuQmy6CXFZW+dgRAHt0MB6A3sGolRlbyfCkc7eKUC+2VtocA2AHHdoWhMTOKAiBlmLOPYON2tAgP12Caq7e1ifXAFgXBgEI9/VAYmcMONGS8+4Z0xUD8jNFqCzWgFq3WXvrCoBm7SQEoukQxAciwPJ3FwhDM6DwXhlK81VAGuzUPAFgb4IsMdofhviOCDAs43RvX8aZhgmF22UozVUA2Z5b8wWAJhAcY4EQ6w/DRvcMGCwGXZgtg6l3r5e2AgALpKcbjhNYC4hIOgR+d42Y3pjmmO6Y9h5NG5nXrLLWJEI3+qUh3TBOmQyMswCePticyEHvzqh1YXrWDShAebFmsTdd8fZVgQFgMCa8wHLcid2zjelVANiITqaF+wDM0wDkEY8ogxDkrdLZLb3GUoYlDUubZzPp7ynLnNgzp/5z5Vrr9rqT2/mPUJM8Q4B+1uvmbuk1khckMTZt9bI/BfInwtCjI7PaW63W6djsT6a5QyYh32coHPDiCM616PVQDKRwa3qNdBVpK9JXr0YB3gBCj++Z0y+1W6sjAPbka2n284TSs0DYfV6d64kHADtPm15btHW6BNiweDZqvE0IOTY8b/zRyVqOAcDFcqPJRziG+W05W+2RK95PCek1GraoXg2btkhvqGqadDw+kXnF6XqOAMiNJj8jSPyvVsrga9tLpxv6Pc66XwajgE2bbW5k8rYA5Ef7Doo9/G/ayeB4ermZImgNbyXKLTDYlFkVZjmL7phvyeSN63LNGG8nk7cWRcf6PiwI/AuOZXCrVlchP1P2XKs7AYEcAwOPOOQYSKAaefkfal17rJVMvgqA7Ed79/Jh7kK3Mvh/2VoJDK17mtoKBGy6sPnCJqwblokyeaVYf0ut64+ulMmbAJQ+kf5zKBE86IcMjny9OFeG4mzFE19HIBjsM7ZHrKbLL98qheql2KWFB3H9JgA3ByVqpVYy5J2+Lh8hNivYsRXnKoAn4MasTjMdtk7dt06TApQWqlCYKcGuabm1JshLnKUFrnu5uIlieSw2L3g/lDOde3ZMb2ymEj5rDZVszaLVmrx0WXdsh7G8YEb0JLp6u6UlTJqiW+iXF2p3PidgXWy4J150flktj2pwEdT66n6iIwC2A0hbkb4ijfXL1up22CwhM/RTb2yUZItdrkfYHANgB43fE+BHQwz5pw4rVdW6b/xUnOWqCnlUg0vt37t0DYANBH4kMCP8PC0/MgtTHFMdU96JdQ2AvfiSOhwFvDTvpuGlhmIJqsFuzDMAVg3FGzu1BMRmq8NLlaUE5QzK4O5KrKMq4AZNFEJREI3tiADLbaw6bOgmFLvkFitjapUBWCc85TOyttj2MMT6kbw4ajQd42yxy9lldml4ptl3iqJTfeIwZcyTBoHDrEcuyPIMxAeiEE2FPMvkyCAtNfi29/7CAKAshReJyZwaXlSmVlFh+yimUsL9BmOeZSh52PHxrDPQ6twGIt3Ra+wwF7DDLIGuepbBwST0FYYyx0fm1XdXuru+KJri95sEnmEAHvIKhFt6bWkM08UmbfWyPwV4DSgc35PRJlqt0/GDej3FfRJFUQAY9eIIzrXo9WAUUBNsZVjD8cT9UIMBYIIAPTo8r19s53dHAHAyBSDXtwsPG6Z+lgH2g16BWEuvrZcYbhXXpa3u9jP+DpR7aiSjOtIFHQFgO4A/fpjqFw4DNU4CMLvdOXbnaPs1nPVeYnC3vnkdCPv08Jx6wc2PLFwBYDv0VwA+0s8fYSg5QYH2u3PU79F0lhJy5vacdv4hcP8zm64AsEOYGYCAonNfpwZ5Eljo9Tu0tusZkCMsPSdy+s92vgfOGoAWC3oCwF5vMgEREIRvA9DvAIAvvxJpE3wFgPzI0NUf7s1CxSvovgBgO/Gv7bCNMfmjhgGPsyz4+p6dYYDMsvBTk9F+8IFZyHoN3J7vKwBNIAYCO4imnjAJc8TrV+0AoBMKv9YN/vTebH3Wr8A3FAB7caTXwJmndQqPuqXXy7T1JWIyJ23a6nfwuN6GZMBaR28khQ/pjHmGALHez+1kSFtZk/necEZ9p9NYr883BYDmZZni91MC5wjAoVaOmwAXGQrHRjKa4198bCkAbGevpbhPkSV6/cDy/yYYSo/vzuiuf/OzJQFAp5Fe30gJ9+Pf78+o7xDrX5tv/wEbguduWrUR0wAAAABJRU5ErkJggg==">
<meta http-equiv="content-type" content="text/html; charset=UTF8">

</head>
<body>
<script>window.settings = {"dbcForumURL":"http://forums.databricks.com/","dbfsS3Host":"https://databricks-prod-storage-oregon.s3.amazonaws.com","enableThirdPartyApplicationsUI":false,"notebookRevisionVisibilityHorizon":0,"enableTableHandler":true,"isAdmin":false,"enablePresentationTimerConfig":true,"enableFullTextSearch":true,"enableNewSearchPanel":true,"enableElasticSparkUI":true,"clusters":false,"hideOffHeapCache":false,"applications":false,"fileStoreBase":"FileStore","configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo\\.registrator","valuePattern":".*","keyPatternDisplay":"spark.kryo.registrator","valuePatternDisplay":"*","description":"A user defined class that has serializer information"},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"}],"enableReactNotebookComments":true,"enableResetPassword":true,"sparkVersions":[{"key":"1.3.x","displayName":"Spark 1.3","packageLabel":"spark-1.3-jenkins-ip-10-2-0-138-Uce350f0a96-Sce350f0a96-2015-10-30-23:30:21.378521","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.4.x","displayName":"Spark 1.4","packageLabel":"spark-1.4-jenkins-ip-10-2-0-138-Uce350f0a96-Sce350f0a96-2015-10-30-23:30:21.378521","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x","displayName":"Spark 1.5","packageLabel":"spark-1.5-jenkins-ip-10-2-0-138-Uce350f0a96-Sce350f0a96-2015-10-30-23:30:21.378521","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"master","displayName":"Spark master (dev)","packageLabel":"","upgradable":true,"deprecated":false,"customerVisible":false}],"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","driverStdoutFilePrefix":"stdout","sparkHistoryServerEnabled":true,"enableIPythonImportExport":true,"enableNotebookHistoryDiffing":true,"branch":"2.5.5","local":false,"displayDefaultContainerMemoryGB":6,"enableIntercom":false,"useSpotForWorkers":false,"enableStaticNotebooks":true,"dbcGuideURL":"#workspace/databricks_guide/00 Welcome to Databricks","enableR":true,"orgId":0,"enableNotebookGitVersioning":true,"files":"files/","enableDriverLogsUI":true,"disableLegacyDashboards":false,"enableWorkspaceAclsConfig":true,"dropzoneMaxFileSize":4096,"driverLog4jFilePrefix":"log4j","enableMavenLibraries":true,"enableNewHelpMenu":true,"gitTimestamp":"2015-10-30 16:24:39 -0700","defaultSparkVersion":{"key":"1.5.x","displayName":"Spark 1.5","packageLabel":"spark-1.5-jenkins-ip-10-2-0-138-Uce350f0a96-Sce350f0a96-2015-10-30-23:30:21.378521","upgradable":true,"deprecated":false,"customerVisible":true},"staticNotebookCdnUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/","clusterPublisherRootId":5,"intercomAppId":"s67zdzhb","enableLatestJobRunResultPermalink":true,"enableSparkConfUI":true,"enableJdbcImport":true,"logfiles":"logfiles/","enableClusterDeltaUpdates":true,"csrfToken":"ddbb3f6b-7e4c-498b-8ccd-855e2ab302fc","useFixedStaticNotebookVersionForDevelopment":false,"enableBasicReactDialogBoxes":true,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"http://feedback.databricks.com/forums/263785-product-feedback","enableWorkspaceAclService":true,"enableWorkspaceAcls":true,"gitHash":"ce350f0a9622b7b742da5cf8d5cb0e2b75e1c4c7-dirty","enableLibraryUI":true,"userFullname":"Alex Zeltov","enableMiniClusters":false,"enableWebSocketDeltaUpdates":true,"enableDebugUI":false,"showHiddenSparkVersions":false,"allowNonAdminUsers":true,"userId":100006,"dbcSupportURL":"","enableSparkPackages":true,"enableNotebookHistoryUI":true,"enableSparkVersionsUI":true,"notebookLoadingBackground":"#fff","enableNewJobRunDetailsPage":true,"enableDashboardExport":true,"user":"azeltov@hortonworks.com","enableServerAutoComplete":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"tablesPublisherRootId":7,"accounts":false,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"defaultZoneId":"us-west-2c"};</script>

<script>var notebookModelJson = {"clusterMemory":0,"name":"Power-Lab3-ML","path":"/1/3561/8446/8688/8863/9064","guid":"bbc9ff07-3b13-44d2-bc4a-d4036f87f8c5","jsRunAllAction":"NoAction","iPythonMetadata":null,"runStatus":"idle","clusterId":"","id":9064,"language":"python","deltaVersion":504222,"targetClusterId":null,"deltaEvent":"full","type":"shell","clusterName":"","parentId":8863,"globalVars":{},"notebookFetchError":null,"permissionLevel":"Can Read","presenceMarks":[]};</script>

<script>var notebookModelCommandCollection = [{"type":"command","id":9066,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"d64df31f-07de-4b49-88cd-04bdcd1d0250","subtype":"command","commandType":"auto","position":1,"command":"%md #Power Plant ML Pipeline Application\nThis is an end-to-end example of using a number of different machine learning algorithms to solve a supervised regression problem.\n\n###Table of Contents\n- *Step 1: Business Understanding*\n- *Step 2: Extract-Transform-Load (ETL) Your Data*\n- *Step 3: Explore Your Data*\n- *Step 4: Visualize Your Data*\n- *Step 5: Data Preparation*\n- *Step 6: Data Modeling*\n\n\n*We are trying to predict power output given a set of readings from various sensors in a gas-fired power generation plant.  Power generation is a complex process, and understanding and predicting power output is an important element in managing a plant and its connection to the power grid.*\n\nMore information about Peaker or Peaking Power Plants can be found on Wikipedia https://en.wikipedia.org/wiki/Peaking_power_plant\n\n\nGiven this business problem, we need to translate it to a Machine Learning task.  The ML task is regression since the label (or target) we are trying to predict is numeric.\n\n\nThe example data is provided by UCI at [UCI Machine Learning Repository Combined Cycle Power Plant Data Set](https://archive.ics.uci.edu/ml/datasets/Combined+Cycle+Power+Plant)\n\nYou can read the background on the UCI page, but in summary we have collected a number of readings from sensors at a Gas Fired Power Plant\n\n(also called a Peaker Plant) and now we want to use those sensor readings to predict how much power the plant will generate.\n\n\nMore information about Machine Learning with Spark can be found in the programming guide in the [SparkML Guide](https://spark.apache.org/docs/latest/mllib-guide.html)\n\n\n*Please note this example only works with Spark version 1.4 or higher*\n","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967325716,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"6a80119a-7677-48af-9e5d-7e606aef3bec","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9066","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9067,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"b6c645ba-b308-4aa3-89e8-21ff96145ba6","subtype":"command","commandType":"auto","position":2,"command":"assert int(sc.version.replace(\".\", \"\")) >= 140, \"Spark 1.4.0+ is required to run this notebook. Please attach it to a Spark 1.4.0+ cluster.\"","commandVersion":0,"results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AssertionError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-5-6e5e53661dbb&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span><span class=\"ansigreen\">assert</span> int<span class=\"ansiyellow\">(</span>sc<span class=\"ansiyellow\">.</span>version<span class=\"ansiyellow\">.</span>replace<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;.&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">&gt;=</span> <span class=\"ansicyan\">150</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;Spark 1.4.0+ is required to run this notebook. Please attach it to a Spark 1.4.0+ cluster.&quot;</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AssertionError</span>: Spark 1.4.0+ is required to run this notebook. Please attach it to a Spark 1.4.0+ cluster.\n</div>","startTime":1442967328179,"submitTime":1442967325770,"finishTime":1442967328237,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"878fede9-0eac-4642-a63a-f825618ced97","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9067","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9068,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"75f1dc96-8abe-47de-9340-5c76ab51a0cd","subtype":"command","commandType":"auto","position":3,"command":"%md ##Step 1: Business Understanding\nThe first step in any machine learning task is to understand the business need. \n\nAs described in the overview we are trying to predict power output given a set of readings from various sensors in a gas-fired power generation plant.\n\nThe problem is a regression problem since the label (or target) we are trying to predict is numeric","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967325793,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"24c8f4b7-4fa3-49de-b314-18766cc29b94","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9068","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9069,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"1b7aba60-b7ae-4d6c-8458-b77ebb134ba1","subtype":"command","commandType":"auto","position":4,"command":"%md ##Step 2: Extract-Transform-Load (ETL) Your Data\n\nNow that we understand what we are trying to do, the first step is to load our data into a format we can query and use.  This is known as ETL or \"Extract-Transform-Load\".  We will load our file from Amazon s3.\n\nNote: Alternatively we could upload our data using \"Databricks Menu > Tables > Create Table\", assuming we had the raw files on our local computer.\n\nOur data is available on Amazon s3 at the following path:  \n`dbfs:/databricks-datasets/power-plant/data`\n\n**ToDo:** Let's start by printing the first 5 lines of the file.  \n*Hint*: To read the file into an RDD use `sc.textFile(\"dbfs:/databricks-datasets/power-plant/data\")`  \n*Hint*: Then you will need to figure out how to `take` and print the first 5 lines of the RDD.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967325830,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"b63a20ee-e202-4e3c-bf51-428be4a82455","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9069","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9070,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"b95e0d89-c2a5-4cdb-aacd-152417be3d74","subtype":"command","commandType":"auto","position":5.5,"command":"rawTextRdd = sc.textFile(\"dbfs:/databricks-datasets/power-plant/data\")\nfor line in rawTextRdd.take(5):\n    print(line)\n","commandVersion":0,"results":{"type":"html","data":"<div class=\"ansiout\">AT\tV\tAP\tRH\tPE\n14.96\t41.76\t1024.07\t73.17\t463.26\n25.18\t62.96\t1020.04\t59.08\t444.37\n5.11\t39.4\t1012.16\t92.14\t488.56\n20.86\t57.32\t1010.24\t76.64\t446.48\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-11-7796a0c523fb&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">1</span>\n<span class=\"ansiyellow\">    rawTextRdd = &quot;sc.textFile(&quot;dbfs:/databricks-datasets/power-plant/data&quot;)</span>\n<span class=\"ansigrey\">                                  ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n\n</div>","startTime":1442967328241,"submitTime":1442967325868,"finishTime":1442967328818,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"783f6234-cc6b-49b5-821b-c46cdc06bc86","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9070","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9071,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"a913bcbd-99c0-49fd-8933-7d30d3e8849d","subtype":"command","commandType":"auto","position":6,"command":"%md The file is a .tsv (Tab Seperated Values) file of floating point numbers.  \n\nOur schema definition from UCI appears below:\n\n- AT = Atmospheric Temperature in C\n- V = Exhaust Vacuum Speed\n- AP = Atmospheric Pressure\n- RH = Relative Humidity\n- PE = Power Output.  This is the value we are trying to predict given the measurements above.\n\n\n**ToDo:** Transform the RDD so that each row is a tuple of float values.  Then print the first 5 rows.  \n*Hint:* Use filter to exclude lines that start with AT to remove the header.  \n*Hint:* Use map to transform each line into a PowerPlantRow of data fields.  \n*Hint:* Use python's str.split break up each line into individual fields.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967325890,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"8082effd-eb12-4bf6-b3ee-5a19fd6b41e7","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9071","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9072,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"0b813687-c6cf-4f4c-b387-99e026ae9165","subtype":"command","commandType":"auto","position":8,"command":"from collections import namedtuple\nPowerPlantRow=namedtuple(\"PowerPlantRow\", [\"AT\", \"V\", \"AP\", \"RH\", \"PE\"])\nrawDataRdd=rawTextRdd\\\n  .map(lambda x: x.split(\"\\t\"))\\\n  .filter(lambda line: line[0] != \"AT\")\\\n  .map(lambda line: PowerPlantRow(float(line[0]), float(line[1]), float(line[2]), float(line[3]), float(line[4])))\nrawDataRdd.take(5)","commandVersion":0,"results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">3</span><span class=\"ansired\">]: </span>\n[PowerPlantRow(AT=14.96, V=41.76, AP=1024.07, RH=73.17, PE=463.26),\n PowerPlantRow(AT=25.18, V=62.96, AP=1020.04, RH=59.08, PE=444.37),\n PowerPlantRow(AT=5.11, V=39.4, AP=1012.16, RH=92.14, PE=488.56),\n PowerPlantRow(AT=20.86, V=57.32, AP=1010.24, RH=76.64, PE=446.48),\n PowerPlantRow(AT=10.82, V=37.5, AP=1009.23, RH=96.62, PE=473.9)]\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Exception</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-15-0b93f3e56098&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> PowerPlantTable<span class=\"ansiyellow\">=</span>namedtuple<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;PowerPlantTable&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&quot;AT&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;V&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;AP&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;RH&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;PE&quot;</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> rawDataRdd<span class=\"ansiyellow\">=</span>rawTextRdd  <span class=\"ansiyellow\">.</span>map<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> x<span class=\"ansiyellow\">:</span> x<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;\\t&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span>  <span class=\"ansiyellow\">.</span>filter<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> line<span class=\"ansiyellow\">:</span> line<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">!=</span> <span class=\"ansiblue\">&quot;AT&quot;</span><span class=\"ansiyellow\">)</span>  <span class=\"ansiyellow\">.</span>map<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> line<span class=\"ansiyellow\">:</span> PowerPlantTable<span class=\"ansiyellow\">(</span>float<span class=\"ansiyellow\">(</span>line<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> float<span class=\"ansiyellow\">(</span>line<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> float<span class=\"ansiyellow\">(</span>line<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">2</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> float<span class=\"ansiyellow\">(</span>line<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">3</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> float<span class=\"ansiyellow\">(</span>line<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">4</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 3</span><span class=\"ansiyellow\"> </span>display<span class=\"ansiyellow\">(</span>rawDataRdd<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/tmp/1437966632527-0/PythonShell.py</span> in <span class=\"ansicyan\">display</span><span class=\"ansiblue\">(self, input)</span>\n<span class=\"ansigreen\">    356</span>             self<span class=\"ansiyellow\">.</span>display<span class=\"ansiyellow\">(</span>input<span class=\"ansiyellow\">.</span>draw<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    357</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 358</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">raise</span> Exception<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;Cannot display object of type %s&quot;</span> <span class=\"ansiyellow\">%</span> type<span class=\"ansiyellow\">(</span>input<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    359</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    360</span>     <span class=\"ansigreen\">def</span> displayHTML<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> html<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">Exception</span>: Cannot display object of type &lt;class &apos;pyspark.rdd.PipelinedRDD&apos;&gt;\n</div>","startTime":1442967328822,"submitTime":1442967325930,"finishTime":1442967329004,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"1f6986af-dc4a-4560-afc2-e8c2d4433cc6","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9072","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9073,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"673e0f07-5617-429e-984b-322bb8b302f7","subtype":"command","commandType":"auto","position":9,"command":"%md ##Step 3: Explore Your Data\nNow that your data is loaded, let's explore it, verify it, and do some basic analysis and visualizations.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967325957,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"3690492f-b56c-4344-bb37-293da8819555","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9073","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9074,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"9c148b69-1e7d-4edd-8eff-9dcd42894ea1","subtype":"command","commandType":"auto","position":9.5,"command":"%md\n**ToDo:** Transform your `rawDataRdd` into a Dataframe named `power_plant`.  Then use the `display(power_plant)` function to visualize it.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967326087,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"bb7b27b6-da4b-4ccd-982e-9aa01fd1f0b5","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9074","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9075,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"d25c0db7-c995-470c-88f2-13067cfa2b8a","subtype":"command","commandType":"auto","position":9.75,"command":"powerPlant=rawDataRdd.toDF()\ndisplay(powerPlant)","commandVersion":0,"results":{"type":"table","data":[[14.96,41.76,1024.07,73.17,463.26],[25.18,62.96,1020.04,59.08,444.37],[5.11,39.4,1012.16,92.14,488.56],[20.86,57.32,1010.24,76.64,446.48],[10.82,37.5,1009.23,96.62,473.9],[26.27,59.44,1012.23,58.77,443.67],[15.89,43.96,1014.02,75.24,467.35],[9.48,44.71,1019.12,66.43,478.42],[14.64,45,1021.78,41.25,475.98],[11.74,43.56,1015.14,70.72,477.5],[17.99,43.72,1008.64,75.04,453.02],[20.14,46.93,1014.66,64.22,453.99],[24.34,73.5,1011.31,84.15,440.29],[25.71,58.59,1012.77,61.83,451.28],[26.19,69.34,1009.48,87.59,433.99],[21.42,43.79,1015.76,43.08,462.19],[18.21,45,1022.86,48.84,467.54],[11.04,41.74,1022.6,77.51,477.2],[14.45,52.75,1023.97,63.59,459.85],[13.97,38.47,1015.15,55.28,464.3],[17.76,42.42,1009.09,66.26,468.27],[5.41,40.07,1019.16,64.77,495.24],[7.76,42.28,1008.52,83.31,483.8],[27.23,63.9,1014.3,47.19,443.61],[27.36,48.6,1003.18,54.93,436.06],[27.47,70.72,1009.97,74.62,443.25],[14.6,39.31,1011.11,72.52,464.16],[7.91,39.96,1023.57,88.44,475.52],[5.81,35.79,1012.14,92.28,484.41],[30.53,65.18,1012.69,41.85,437.89],[23.87,63.94,1019.02,44.28,445.11],[26.09,58.41,1013.64,64.58,438.86],[29.27,66.85,1011.11,63.25,440.98],[27.38,74.16,1010.08,78.61,436.65],[24.81,63.94,1018.76,44.51,444.26],[12.75,44.03,1007.29,89.46,465.86],[24.66,63.73,1011.4,74.52,444.37],[16.38,47.45,1010.08,88.86,450.69],[13.91,39.35,1014.69,75.51,469.02],[23.18,51.3,1012.04,78.64,448.86],[22.47,47.45,1007.62,76.65,447.14],[13.39,44.85,1017.24,80.44,469.18],[9.28,41.54,1018.33,79.89,482.8],[11.82,42.86,1014.12,88.28,476.7],[10.27,40.64,1020.63,84.6,474.99],[22.92,63.94,1019.28,42.69,444.22],[16,37.87,1020.24,78.41,461.33],[21.22,43.43,1010.96,61.07,448.06],[13.46,44.71,1014.51,50,474.6],[9.39,40.11,1029.14,77.29,473.05],[31.07,73.5,1010.58,43.66,432.06],[12.82,38.62,1018.71,83.8,467.41],[32.57,78.92,1011.6,66.47,430.12],[8.11,42.18,1014.82,93.09,473.62],[13.92,39.39,1012.94,80.52,471.81],[23.04,59.43,1010.23,68.99,442.99],[27.31,64.44,1014.65,57.27,442.77],[5.91,39.33,1010.18,95.53,491.49],[25.26,61.08,1013.68,71.72,447.46],[27.97,58.84,1002.25,57.88,446.11],[26.08,52.3,1007.03,63.34,442.44],[29.01,65.71,1013.61,48.07,446.22],[12.18,40.1,1016.67,91.87,471.49],[13.76,45.87,1008.89,87.27,463.5],[25.5,58.79,1016.02,64.4,440.01],[28.26,65.34,1014.56,43.4,441.03],[21.39,62.96,1019.49,72.24,452.68],[7.26,40.69,1020.43,90.22,474.91],[10.54,34.03,1018.71,74,478.77],[27.71,74.34,998.14,71.85,434.2],[23.11,68.3,1017.83,86.62,437.91],[7.51,41.01,1024.61,97.41,477.61],[26.46,74.67,1016.65,84.44,431.65],[29.34,74.34,998.58,81.55,430.57],[10.32,42.28,1008.82,75.66,481.09],[22.74,61.02,1009.56,79.41,445.56],[13.48,39.85,1012.71,58.91,475.74],[25.52,69.75,1010.36,90.06,435.12],[21.58,67.25,1017.39,79,446.15],[27.66,76.86,1001.31,69.47,436.64],[26.96,69.45,1013.89,51.47,436.69],[12.29,42.18,1016.53,83.13,468.75],[15.86,43.02,1012.18,40.33,466.6],[13.87,45.08,1024.42,81.69,465.48],[24.09,73.68,1014.93,94.55,441.34],[20.45,69.45,1012.53,91.81,441.83],[15.07,39.3,1019,63.62,464.7],[32.72,69.75,1009.6,49.35,437.99],[18.23,58.96,1015.55,69.61,459.12],[35.56,68.94,1006.56,38.75,429.69],[18.36,51.43,1010.57,90.17,459.8],[26.35,64.05,1009.81,81.24,433.63],[25.92,60.95,1014.62,48.46,442.84],[8.01,41.66,1014.49,76.72,485.13],[19.63,52.72,1025.09,51.16,459.12],[20.02,67.32,1012.05,76.34,445.31],[10.08,40.72,1022.7,67.3,480.8],[27.23,66.48,1005.23,52.38,432.55],[23.37,63.77,1013.42,76.44,443.86],[18.74,59.21,1018.3,91.55,449.77],[14.81,43.69,1017.19,71.9,470.71],[23.1,51.3,1011.93,80.05,452.17],[10.72,41.38,1021.6,63.77,478.29],[29.46,71.94,1006.96,62.26,428.54],[8.1,40.64,1020.66,89.04,478.27],[27.29,62.66,1007.63,58.02,439.58],[17.1,49.69,1005.53,81.82,457.32],[11.49,44.2,1018.79,91.14,475.51],[23.69,65.59,1010.85,88.92,439.66],[13.51,40.89,1011.03,84.83,471.99],[9.64,39.35,1015.1,91.76,479.81],[25.65,78.92,1010.83,86.56,434.78],[21.59,61.87,1011.18,57.21,446.58],[27.98,58.33,1013.92,54.25,437.76],[18.8,39.72,1001.24,63.8,459.36],[18.28,44.71,1016.99,33.71,462.28],[13.55,43.48,1016.08,67.25,464.33],[22.99,46.21,1010.71,60.11,444.36],[23.94,59.39,1014.32,74.55,438.64],[13.74,34.03,1018.69,67.34,470.49],[21.3,41.1,1001.86,42.75,455.13],[27.54,66.93,1017.06,55.2,450.22],[24.81,63.73,1009.34,83.61,440.43],[4.97,42.85,1014.02,88.78,482.98],[15.22,50.88,1014.19,100.12,460.44],[23.88,54.2,1012.81,64.52,444.97],[33.01,68.67,1005.2,51.41,433.94],[25.98,73.18,1012.28,85.78,439.73],[28.18,73.88,1005.89,75.41,434.48],[21.67,60.84,1017.93,81.63,442.33],[17.67,45.09,1014.26,51.92,457.67],[21.37,57.76,1018.8,70.12,454.66],[28.69,67.25,1017.71,53.83,432.21],[16.61,43.77,1012.25,77.23,457.66],[27.91,63.76,1010.27,65.67,435.21],[20.97,47.43,1007.64,71.18,448.22],[10.8,41.66,1013.79,81.96,475.51],[20.61,62.91,1013.24,79.54,446.53],[25.45,57.32,1011.7,47.09,441.3],[30.16,69.34,1007.67,57.69,433.54],[4.99,39.04,1020.45,78.89,472.52],[10.51,44.78,1012.59,85.29,474.77],[33.79,69.05,1001.62,40.13,435.1],[21.34,59.8,1016.92,77.06,450.74],[23.4,65.06,1014.32,67.38,442.7],[32.21,68.14,1003.34,62.44,426.56],[14.26,42.32,1016,77.43,463.71],[27.71,66.93,1016.85,58.77,447.06],[21.95,57.76,1018.02,67.72,452.27],[25.76,63.94,1018.49,42.14,445.78],[23.68,68.3,1017.93,84.16,438.65],[8.28,40.77,1011.55,89.79,480.15],[23.44,62.52,1016.46,67.21,447.19],[25.32,48.41,1008.47,72.14,443.04],[3.94,39.9,1008.06,97.49,488.81],[17.3,57.76,1016.26,87.74,455.75],[18.2,49.39,1018.83,96.3,455.86],[21.43,46.97,1013.94,61.25,457.68],[11.16,40.05,1014.95,88.38,479.11],[30.38,74.16,1007.44,74.77,432.84],[23.36,62.52,1016.18,68.18,448.37],[21.69,47.45,1007.56,77.2,447.06],[23.62,49.21,1014.1,49.54,443.53],[21.87,61.45,1011.13,92.22,445.21],[29.25,66.51,1015.53,33.65,441.7],[20.03,66.86,1013.05,64.59,450.93],[18.14,49.78,1002.95,100.09,451.44],[24.23,56.89,1012.32,68.04,441.29],[18.11,44.85,1014.48,48.94,458.85],[6.57,43.65,1018.24,74.47,481.46],[12.56,43.41,1016.93,81.02,467.19],[13.4,41.58,1020.5,71.17,461.54],[27.1,52.84,1006.28,53.85,439.08],[14.28,42.74,1028.79,70.67,467.22],[16.29,44.34,1019.49,59.36,468.8],[31.24,71.98,1004.66,57.17,426.93],[10.57,37.73,1024.36,70.29,474.65],[13.8,44.21,1022.93,83.37,468.97],[25.3,71.58,1010.18,87.36,433.97],[18.06,50.16,1009.52,100.09,450.53],[25.42,59.04,1011.98,68.78,444.51],[15.07,40.69,1015.29,70.98,469.03],[11.75,71.14,1019.36,75.68,466.56],[20.23,52.05,1012.15,47.49,457.57],[27.31,59.54,1006.24,71.99,440.13],[28.57,69.84,1003.57,66.55,433.24],[17.9,43.72,1008.64,74.73,452.55],[23.83,71.37,1002.04,64.78,443.29],[27.92,74.99,1005.47,75.13,431.76],[17.34,44.78,1007.81,56.38,454.97],[17.94,63.07,1012.42,94.35,456.7],[6.4,39.9,1007.75,86.55,486.03],[11.78,39.96,1011.37,82.95,472.79],[20.28,57.25,1010.12,88.42,452.03],[21.04,54.2,1012.26,85.61,443.41],[25.11,67.32,1014.49,58.39,441.93],[30.28,70.98,1007.51,74.28,432.64],[8.14,36.24,1013.15,87.85,480.25],[16.86,39.63,1004.47,83.5,466.68],[6.25,40.07,1020.19,65.24,494.39],[22.35,54.42,1012.46,75.01,454.72],[17.98,56.85,1012.28,84.52,448.71],[21.19,42.48,1013.43,80.52,469.76],[20.94,44.89,1009.64,75.14,450.71],[24.23,58.79,1009.8,75.75,444.01],[19.18,58.2,1017.46,76.72,453.2],[20.88,57.85,1012.39,85.47,450.87],[23.67,63.86,1019.67,57.95,441.73],[14.12,39.52,1018.41,78.32,465.09],[25.23,64.63,1020.59,52.2,447.28],[6.54,39.33,1011.54,93.69,491.16],[20.08,62.52,1017.99,75.74,450.98],[24.67,63.56,1013.75,67.56,446.3],[27.82,79.74,1008.37,69.46,436.48],[15.55,42.03,1017.41,74.58,460.84],[24.26,69.51,1013.43,53.23,442.56],[13.45,41.49,1020.19,88.72,467.3],[11.06,40.64,1021.47,96.16,479.13],[24.91,52.3,1008.72,68.26,441.15],[22.39,59.04,1011.78,86.39,445.52],[11.95,40.69,1015.62,85.34,475.4],[14.85,40.69,1014.91,72.64,469.3],[10.11,41.62,1017.17,97.82,463.57],[23.67,68.67,1006.71,77.22,445.32],[16.14,44.21,1020.36,80.59,461.03],[15.11,43.13,1014.99,46.91,466.74],[24.14,59.87,1018.47,57.76,444.04],[30.08,67.25,1017.6,53.09,434.01],[14.77,44.9,1020.5,84.31,465.23],[27.6,69.34,1009.63,71.58,440.6],[13.89,44.84,1023.66,92.97,466.74],[26.85,75.6,1017.43,74.55,433.48],[12.41,40.96,1023.36,78.96,473.59],[13.08,41.74,1020.75,64.44,474.81],[18.93,44.06,1017.58,68.23,454.75],[20.5,49.69,1009.6,70.81,452.94],[30.72,69.13,1009.94,61.66,435.83],[7.55,39.22,1014.53,77.76,482.19],[13.49,44.47,1030.46,69.49,466.66],[15.62,40.12,1013.03,96.26,462.59],[24.8,64.63,1020.69,55.74,447.82],[10.03,41.62,1014.55,95.61,462.73],[22.43,63.21,1012.06,84.75,447.98],[14.95,39.31,1009.15,75.3,462.72],[24.78,58.46,1016.82,67.5,442.42],[23.2,48.41,1008.64,80.92,444.69],[14.01,39,1016.73,79.23,466.7],[19.4,64.63,1020.38,81.1,453.84],[30.15,67.32,1013.83,32.8,436.92],[6.91,36.08,1021.82,84.31,486.37],[29.04,60.07,1015.42,46.15,440.43],[26.02,63.07,1010.94,53.96,446.82],[5.89,39.48,1005.11,59.83,484.91],[26.52,71.64,1008.27,75.3,437.76],[28.53,68.08,1013.27,42.53,438.91],[16.59,39.54,1007.97,70.58,464.19],[22.95,67.79,1009.89,91.69,442.19],[23.96,47.43,1008.38,63.55,446.86],[17.48,44.2,1018.89,61.51,457.15],[6.69,43.65,1020.14,69.55,482.57],[10.25,41.26,1007.44,98.08,476.03],[28.87,72.58,1008.69,79.34,428.89],[12.04,40.23,1018.07,81.28,472.7],[22.58,52.3,1009.04,78.99,445.6],[15.12,52.05,1014.63,80.38,464.78],[25.48,58.95,1017.02,51.16,440.42],[27.87,70.79,1003.96,72.17,428.41],[23.72,70.47,1010.65,75.39,438.5],[25,59.43,1007.84,68.91,438.28],[8.42,40.64,1022.35,96.38,476.29],[22.46,58.49,1011.5,70.54,448.46],[29.92,57.19,1008.62,45.8,438.99],[11.68,39.22,1017.9,57.95,471.8],[14.04,42.44,1012.74,81.89,471.81],[19.86,59.14,1016.12,69.32,449.82],[25.99,68.08,1013.13,59.14,442.14],[23.42,58.79,1009.74,81.54,441.46],[10.6,40.22,1011.37,85.81,477.62],[20.97,61.87,1011.45,65.41,446.76],[14.14,39.82,1012.46,81.15,472.52],[8.56,40.71,1021.27,95.87,471.58],[24.86,72.39,1001.15,90.24,440.85],[29,77.54,1011.33,75.13,431.37],[27.59,71.97,1008.64,88.22,437.33],[10.45,40.71,1015.68,81.48,469.22],[8.51,40.78,1023.51,89.84,471.11],[29.82,66.51,1010.98,43.57,439.17],[22.56,62.26,1012.11,63.16,445.33],[11.38,39.22,1018.62,57.14,473.71],[20.25,57.76,1016.28,77.76,452.66],[22.42,59.43,1007.12,90.56,440.99],[14.85,38.91,1014.48,60.98,467.42],[25.62,58.82,1010.02,70.31,444.14],[19.85,56.53,1020.57,74.05,457.17],[13.67,54.3,1015.92,75.42,467.87],[24.39,70.72,1009.78,82.25,442.04],[16.07,44.58,1019.52,67.95,471.36],[11.6,39.1,1009.81,100.09,460.7],[31.38,70.83,1010.35,47.28,431.33],[29.91,76.86,998.59,72.41,432.6],[19.67,59.39,1014.07,77.67,447.61],[27.18,64.79,1016.27,63.7,443.87],[21.39,52.3,1009.2,79.77,446.87],[10.45,41.01,1020.57,93.84,465.74],[19.46,56.89,1014.02,84.95,447.86],[23.55,62.96,1020.16,70.16,447.65],[23.35,63.47,1011.78,84.24,437.87],[9.26,41.66,1016.87,73.32,483.51],[10.3,41.46,1018.21,86.17,479.65],[20.94,58.16,1016.88,65.43,455.16],[23.13,71.25,1002.49,94.59,431.91],[12.77,41.5,1014.13,86.8,470.68],[28.29,69.13,1009.29,58.18,429.28],[19.13,59.21,1018.32,89.66,450.81],[24.44,73.5,1011.49,87.39,437.73],[20.32,44.6,1015.16,36.35,460.21],[20.54,69.05,1001.6,79.62,442.86],[12.16,45,1021.51,50.52,482.99],[28.09,65.27,1013.27,51.96,440],[9.25,41.82,1033.25,74.73,478.48],[21.75,49.82,1015.01,78.33,455.28],[23.7,66.56,1002.07,85.19,436.94],[16.22,37.87,1022.36,83.13,461.06],[24.75,69.45,1013.97,53.49,438.28],[10.48,39.58,1011.81,88.86,472.61],[29.53,70.79,1003.7,60.89,426.85],[12.59,39.72,1017.76,61.14,470.18],[23.5,54.42,1012.31,68.29,455.38],[29.01,66.56,1006.44,57.62,428.32],[9.75,42.49,1010.57,83.63,480.35],[19.55,56.53,1020.2,78.1,455.56],[21.05,58.33,1013.14,66.34,447.66],[24.72,68.67,1006.74,79.02,443.06],[21.19,58.86,1014.19,68.96,452.43],[10.77,41.54,1019.94,71.13,477.81],[28.68,73.77,1004.72,87.01,431.66],[29.87,73.91,1004.53,74.3,431.8],[22.99,68.67,1006.65,77.62,446.67],[24.66,60.29,1018,59.56,445.26],[32.63,69.89,1013.85,41.66,425.72],[31.38,72.29,1008.73,73.27,430.58],[23.87,60.27,1018.94,77.16,439.86],[25.6,59.15,1013.31,67.02,441.11],[27.62,71.14,1011.6,52.8,434.72],[30.1,67.45,1014.23,39.04,434.01],[12.19,41.17,1019.43,65.47,475.64],[13.11,41.58,1020.43,74.32,460.44],[28.29,68.67,1005.46,69.22,436.4],[13.45,40.73,1018.7,93.88,461.03],[10.98,41.54,1019.94,69.83,479.08],[26.48,69.14,1009.31,84.11,435.76],[13.07,45.51,1015.22,78.65,460.14],[25.56,75.6,1017.37,69.31,442.2],[22.68,50.78,1008.83,70.3,447.69],[28.86,73.67,1006.65,68.23,431.15],[22.7,63.56,1014.32,71.76,445],[27.89,73.21,1001.32,85.88,431.59],[13.78,44.47,1027.94,71.09,467.22],[28.14,51.43,1012.16,52.67,445.33],[11.8,45.09,1013.21,89.68,470.57],[10.71,39.61,1018.72,73.66,473.77],[24.54,60.29,1017.42,58.94,447.67],[11.54,40.05,1014.78,87.05,474.29],[29.47,71.32,1008.07,67,437.14],[29.24,69.05,1003.12,43.18,432.56],[14.51,41.79,1009.72,80.62,459.14],[22.91,60.07,1016.03,59.72,446.19],[27.02,71.77,1006.38,72.1,428.1],[13.49,44.47,1030.18,69.15,468.46],[30.24,66.75,1017.95,55.66,435.02],[23.19,48.6,1002.38,61.19,445.52],[17.73,40.55,1003.36,74.62,462.69],[18.62,61.27,1019.26,73.35,455.75],[12.85,40,1015.89,68.85,463.74],[32.33,69.68,1011.95,39.89,439.79],[25.09,58.95,1016.99,53.16,443.26],[29.45,69.13,1009.3,52.97,432.04],[16.91,43.96,1013.32,79.87,465.86],[14.09,45.87,1009.05,84.09,465.6],[10.73,25.36,1009.35,100.15,469.43],[23.2,49.3,1003.4,79.77,440.75],[8.21,38.91,1015.82,88.99,481.32],[9.3,40.56,1022.64,76.14,479.87],[16.97,39.16,1005.7,69.13,458.59],[23.69,71.97,1009.62,93.03,438.62],[25.13,59.44,1012.38,77.92,445.59],[9.86,43.56,1015.13,74.89,481.87],[11.33,41.5,1013.58,88.7,475.01],[26.95,48.41,1008.53,62.94,436.54],[15,40.66,1016.28,89.62,456.63],[20.76,62.52,1015.63,81.04,451.69],[14.29,39.59,1010.93,94.53,463.04],[19.74,67.71,1007.68,64.02,446.1],[26.68,59.92,1009.94,70.57,438.67],[14.24,41.4,1019.7,70.32,466.88],[21.98,48.41,1008.42,84.86,444.6],[22.75,59.39,1015.4,81.41,440.26],[8.34,40.96,1023.28,89.45,483.92],[11.8,41.2,1017.18,82.71,475.19],[8.81,44.68,1023.06,93.93,479.24],[30.05,73.68,1014.95,70.6,434.92],[16.01,65.46,1014,87.68,454.16],[21.75,58.79,1012.42,87.58,447.58],[13.94,41.26,1021.67,74.4,467.9],[29.25,69.13,1010.27,67.35,426.29],[22.33,45.87,1007.8,63.61,447.02],[16.43,41.79,1005.47,76.89,455.85],[11.5,40.22,1010.31,78.08,476.46],[23.53,68.94,1007.53,69.17,437.48],[21.86,49.21,1014.61,53.31,452.77],[6.17,39.33,1012.57,93.32,491.54],[30.19,64.79,1017.22,42.47,438.41],[11.67,41.93,1019.81,82.58,476.1],[15.34,36.99,1007.87,94.59,464.58],[11.5,40.78,1023.91,86.31,467.74],[25.53,57.17,1010,72.57,442.12],[21.27,57.5,1014.53,80.76,453.34],[28.37,69.13,1010.44,71.93,425.29],[28.39,51.43,1011.74,47.54,449.63],[13.78,45.78,1025.27,95.72,462.88],[14.6,42.32,1015.71,77.03,464.67],[5.1,35.57,1027.17,80.49,489.96],[7,38.08,1020.27,77.67,482.38],[26.3,77.95,1009.45,78.72,437.95],[30.56,71.98,1004.74,58.77,429.2],[21.09,46.63,1013.03,74.8,453.34],[28.21,70.02,1010.58,51.34,442.47],[15.84,49.69,1015.14,90.41,462.6],[10.03,40.96,1024.57,91.1,478.79],[20.37,52.05,1012.34,62.57,456.11],[21.19,50.16,1005.81,84.27,450.33],[33.73,69.88,1007.21,42.93,434.83],[29.87,73.68,1015.1,40.96,433.43],[19.62,62.96,1020.76,76.53,456.02],[9.93,40.67,1018.08,69.74,485.23],[9.43,37.14,1013.03,74.99,473.57],[14.24,39.58,1011.17,70.45,469.94],[12.97,49.83,1008.69,91.49,452.07],[7.6,41.04,1021.82,88.97,475.32],[8.39,36.24,1013.39,89.13,480.69],[25.41,48.06,1013.12,46.52,444.01],[18.43,56.03,1020.41,60.55,465.17],[10.31,39.82,1012.87,88.71,480.61],[11.29,41.5,1013.39,89.15,476.04],[22.61,49.3,1003.51,83.02,441.76],[29.34,71.98,1005.19,75.19,428.24],[18.87,67.71,1004,87.35,444.77],[13.21,45.87,1008.58,85.66,463.1],[11.3,44.6,1018.19,91.66,470.5],[29.23,72.99,1007.04,63.47,431],[27.76,69.4,1004.27,72.25,430.68],[29.26,67.17,1006.6,70.58,436.42],[25.72,49.82,1016.19,60.1,452.33],[23.43,63.94,1010.64,89.29,440.16],[25.6,63.76,1010.18,67.43,435.75],[22.3,44.57,1008.48,67.58,449.74],[27.91,72.24,1010.74,70.8,430.73],[30.35,77.17,1009.55,63.62,432.75],[21.78,47.43,1007.88,66.68,446.79],[7.19,41.39,1018.12,90.76,486.35],[20.88,59.8,1015.66,75.34,453.18],[24.19,50.23,1015.73,59.77,458.31],[9.98,41.54,1019.7,80.79,480.26],[23.47,51.3,1011.89,74.1,448.65],[26.35,49.5,1012.67,41.34,458.41],[29.89,64.69,1006.37,58.78,435.39],[19.29,50.16,1010.49,97.78,450.21],[17.48,43.14,1018.68,74.85,459.59],[25.21,75.6,1017.19,69.84,445.84],[23.3,48.78,1018.17,75.36,441.08],[15.42,37.85,1009.89,85.8,467.33],[21.44,63.09,1016.56,90.11,444.19],[29.45,68.27,1007.96,61.63,432.96],[29.69,47.93,1002.85,44.76,438.09],[15.52,36.99,1006.86,89.7,467.9],[11.47,43.67,1012.68,72.51,475.72],[9.77,34.69,1027.72,74.98,477.51],[22.6,69.84,1006.37,79.59,435.13],[8.24,39.61,1017.99,78.42,477.9],[17.01,44.2,1019.18,61.23,457.26],[19.64,44.6,1015.88,47.56,467.53],[10.61,41.58,1021.08,93.06,465.15],[12.04,40.1,1014.42,89.65,474.28],[29.19,65.71,1013.85,50.5,444.49],[21.75,45.09,1014.15,44.84,452.84],[23.66,77.54,1008.5,85.32,435.38],[27.05,75.33,1003.88,82.94,433.57],[29.63,69.71,1009.04,67.26,435.27],[18.2,39.63,1005.35,79.05,468.49],[32.22,70.8,1009.9,62.03,433.07],[26.88,73.56,1004.85,94.36,430.63],[29.05,65.74,1013.29,60.02,440.74],[8.9,39.96,1026.31,95.46,474.49],[18.93,48.6,1005.72,84.92,449.74],[27.49,63.76,1010.09,62.8,436.73],[23.1,70.79,1006.53,90.81,434.58],[11.22,43.13,1017.24,80.9,473.93],[31.97,79.74,1007.03,55.84,435.99],[13.32,43.22,1009.45,75.3,466.83],[31.68,68.24,1005.29,37.34,427.22],[23.69,63.77,1013.39,79.5,444.07],[13.83,41.49,1020.11,87.29,469.57],[18.32,66.51,1015.18,81.5,459.89],[11.05,40.71,1024.91,76.42,479.59],[22.03,64.69,1007.21,75.75,440.92],[10.23,41.46,1020.45,84.95,480.87],[23.92,66.54,1009.93,62.37,441.9],[29.38,69.68,1011.35,49.25,430.2],[17.35,42.86,1014.62,74.16,465.16],[9.81,44.45,1021.19,90.55,471.32],[4.97,40.64,1020.91,94.28,485.43],[5.15,40.07,1012.27,63.31,495.35],[21.54,58.49,1010.85,78.9,449.12],[7.94,42.02,1006.22,90.97,480.53],[18.77,50.66,1014.89,87.34,457.07],[21.69,69.94,1010.7,80.8,443.67],[10.07,44.68,1023.44,90.95,477.52],[13.83,39.64,1012.52,69.97,472.95],[10.45,39.69,1003.92,89.45,472.54],[11.56,40.71,1015.85,76.08,469.17],[23.64,70.04,1011.09,83.35,435.21],[10.48,40.22,1004.81,92.16,477.78],[13.09,39.85,1012.86,58.42,475.89],[10.67,40.23,1017.75,85.06,483.9],[12.57,39.16,1016.53,88.91,476.2],[14.45,43.34,1015.47,83.33,462.16],[14.22,37.85,1011.24,88.49,471.05],[6.97,41.26,1010.6,96.88,484.71],[20.61,63.86,1015.43,73.86,446.34],[14.67,42.28,1007.21,65.17,469.02],[29.06,72.86,1004.23,69.41,432.12],[14.38,40.1,1015.51,81.23,467.28],[32.51,69.98,1013.29,54.07,429.66],[11.79,45.09,1013.16,89.17,469.49],[8.65,40.56,1023.23,78.85,485.87],[9.75,40.81,1026,84.44,481.95],[9.11,40.02,1031.1,83.02,479.03],[23.39,69.13,1010.99,90.66,434.5],[14.3,54.3,1015.16,75.29,464.9],[17.49,63.94,1020.02,82.6,452.71],[31.1,69.51,1010.84,45.4,429.74],[19.77,56.65,1020.67,66.33,457.09],[28.61,72.29,1011.61,45.33,446.77],[13.52,41.48,1014.46,67.12,460.76],[13.52,40.83,1008.31,84.14,471.95],[17.57,46.21,1014.09,80.81,453.29],[28.18,60.07,1016.34,49.13,441.61],[14.29,46.18,1017.01,87.29,464.73],[18.12,43.69,1016.91,52.95,464.68],[31.27,73.91,1003.72,68.92,430.59],[26.24,77.95,1014.19,85.21,438.01],[7.44,41.04,1021.84,88.56,479.08],[29.78,74.78,1009.28,55.09,436.39],[23.37,65.46,1016.25,48.64,447.07],[10.62,39.58,1011.9,87.85,479.91],[5.84,43.02,1013.88,87.42,489.05],[14.51,53.82,1016.46,62.75,463.17],[11.31,42.02,1001.18,94.86,471.26],[11.25,40.67,1011.64,63.54,480.49],[9.18,39.42,1025.41,69.46,473.78],[19.82,58.16,1016.76,74.66,455.5],[24.77,58.41,1013.78,80.57,446.27],[9.66,41.06,1021.21,84.7,482.2],[21.96,59.8,1016.72,72.6,452.48],[18.59,43.14,1011.92,52.63,464.48],[24.75,69.89,1015.29,82.01,438.1],[24.37,63.47,1012.77,75.22,445.6],[29.6,67.79,1010.37,51.05,442.43],[25.32,61.25,1011.56,80.1,436.67],[16.15,41.85,1016.54,81.58,466.56],[15.74,71.14,1019.65,65.94,457.29],[5.97,36.25,1029.65,86.74,487.03],[15.84,52.72,1026.45,62.57,464.93],[14.84,44.63,1019.28,57.37,466],[12.25,48.79,1017.44,88.91,469.52],[27.38,70.04,1011.18,72.26,428.88],[8.76,41.48,1018.49,74.98,474.3],[15.54,39.31,1009.69,71.19,461.06],[18.71,39.39,1014.09,62.82,465.57],[13.06,41.78,1012.3,55.31,467.67],[12.72,40.71,1016.02,71.57,466.99],[19.83,39.39,1013.73,59.16,463.72],[27.23,49.16,1004.03,40.8,443.78],[24.27,68.28,1005.43,67.63,445.23],[11.8,40.66,1017.13,97.2,464.43],[6.76,36.25,1028.31,91.16,484.36],[25.99,63.07,1012.5,64.81,442.16],[16.3,39.63,1004.64,85.61,464.11],[16.5,49.39,1018.35,93.42,462.48],[10.59,42.49,1009.59,77.36,477.49],[26.05,65.59,1012.78,67.03,437.04],[19.5,40.79,1003.8,89.45,457.09],[22.21,45.01,1012.22,54.84,450.6],[17.86,45,1023.25,53.48,465.78],[29.96,70.04,1010.15,54.47,427.1],[19.08,44.63,1020.14,43.36,459.81],[23.59,47.43,1006.64,48.92,447.36],[3.38,39.64,1011,81.22,488.92],[26.39,66.49,1012.96,60.35,433.36],[8.99,39.04,1021.99,75.98,483.35],[10.91,41.04,1026.57,74.24,469.53],[13.08,39.82,1012.27,85.21,476.96],[23.95,58.46,1017.5,68.46,440.75],[15.64,43.71,1024.51,78.31,462.55],[18.78,54.2,1012.05,89.25,448.04],[20.65,50.59,1016.22,68.57,455.24],[4.96,40.07,1011.8,67.38,494.75],[23.51,57.32,1012.55,53.6,444.58],[5.99,35.79,1011.56,91.69,484.82],[23.65,66.05,1019.6,78.21,442.9],[5.17,39.33,1009.68,94.19,485.46],[26.38,49.5,1012.82,37.19,457.81],[6.02,43.65,1013.85,83.53,481.92],[23.2,61.02,1009.63,79.45,443.23],[8.57,39.69,1000.91,99.9,474.29],[30.72,71.58,1009.98,50.39,430.46],[21.52,50.66,1013.56,74.33,455.71],[22.93,62.26,1011.25,83.66,438.34],[5.71,41.31,1003.24,89.48,485.83],[18.62,44.06,1017.76,64.59,452.82],[27.88,68.94,1007.68,75.68,435.04],[22.32,59.8,1016.82,64.18,451.21],[14.55,42.74,1028.41,70.09,465.81],[17.83,44.92,1025.04,70.58,458.42],[9.68,39.96,1026.09,99.28,470.22],[19.41,49.39,1020.84,81.89,449.24],[13.22,44.92,1023.84,87.99,471.43],[12.24,44.92,1023.74,88.21,473.26],[19.21,58.49,1011.7,91.29,452.82],[29.74,70.32,1008.1,52.72,432.69],[23.28,60.84,1017.91,67.5,444.13],[8.02,41.92,1029.8,92.05,467.21],[22.47,48.6,1002.33,63.23,445.98],[27.51,73.77,1002.42,90.88,436.91],[17.51,44.9,1009.05,74.91,455.01],[23.22,66.56,1002.47,85.39,437.11],[11.73,40.64,1020.68,96.98,477.06],[21.19,67.71,1006.65,56.28,441.71],[5.48,40.07,1019.63,65.62,495.76],[24.26,66.44,1011.33,55.32,445.63],[12.32,41.62,1012.88,88.88,464.72],[31.26,68.94,1005.94,39.49,438.03],[32.09,72.86,1003.47,54.59,434.78],[24.98,60.32,1015.63,57.19,444.67],[27.48,61.41,1012.2,45.06,452.24],[21.04,45.09,1014.19,40.62,450.92],[27.75,70.4,1006.65,90.21,436.53],[22.79,71.77,1005.75,90.91,435.53],[24.22,68.51,1013.23,74.96,440.01],[27.06,64.45,1008.72,54.21,443.1],[29.25,71.94,1007.18,63.62,427.49],[26.86,68.08,1012.99,50.04,436.25],[29.64,67.79,1009.99,51.23,440.74],[19.92,63.31,1015.02,82.71,443.54],[18.5,51.43,1010.82,92.04,459.42],[23.71,60.23,1009.76,90.67,439.66],[14.39,44.84,1023.55,91.14,464.15],[19.3,56.65,1020.55,70.43,459.1],[24.65,52.36,1014.76,66.63,455.68],[13.5,45.51,1015.33,86.95,469.08],[9.82,41.26,1007.71,96.69,478.02],[18.4,44.06,1017.36,70.88,456.8],[28.12,44.89,1009.18,47.14,441.13],[17.15,43.69,1017.05,63.36,463.88],[30.69,73.67,1006.14,60.58,430.45],[28.82,65.71,1014.24,54.3,449.18],[21.3,48.92,1010.92,65.09,447.89],[30.58,70.04,1010.4,48.16,431.59],[21.17,52.3,1009.36,81.51,447.5],[9.87,41.82,1033.04,68.57,475.58],[22.18,59.8,1016.77,73.16,453.24],[24.39,63.21,1012.59,80.88,446.4],[10.73,44.92,1025.1,85.4,476.81],[9.38,40.46,1019.29,75.77,474.1],[20.27,57.76,1016.66,75.76,450.71],[24.82,66.48,1006.4,70.21,433.62],[16.55,41.66,1011.45,55.53,465.14],[20.73,59.87,1019.08,80.48,445.18],[9.51,39.22,1015.3,72.41,474.12],[8.63,43.79,1016.08,83.25,483.91],[6.48,40.27,1010.55,82.12,486.68],[14.95,43.52,1022.43,94.75,464.98],[5.76,45.87,1010.83,95.79,481.4],[10.94,39.04,1021.81,86.02,479.2],[15.87,41.16,1005.85,78.29,463.86],[12.42,38.25,1012.76,82.23,472.3],[29.12,58.84,1001.31,52.86,446.51],[29.12,51.43,1005.93,60.66,437.71],[19.08,41.1,1001.96,62.77,458.94],[31.06,67.17,1007.62,65.54,437.91],[5.72,39.33,1009.96,95.4,490.76],[26.52,65.06,1013.4,51.78,439.66],[13.84,44.9,1007.58,63.62,463.27],[13.03,39.52,1016.68,83.09,473.99],[25.94,66.49,1012.83,61.81,433.38],[16.64,53.82,1015.13,68.24,459.01],[14.13,40.75,1016.05,72.41,471.44],[13.65,39.28,1012.97,79.64,471.91],[14.5,44.47,1028.2,66.95,465.15],[19.8,51.19,1008.25,91.98,446.66],[25.2,63.76,1009.78,64.96,438.15],[20.66,51.19,1008.81,88.93,447.14],[12.07,43.71,1025.53,85.62,472.32],[25.64,70.72,1010.16,84,441.68],[23.33,72.99,1009.33,89.41,440.04],[29.41,64.05,1009.82,67.4,444.82],[16.6,53.16,1014.5,76.75,457.26],[27.53,72.58,1009.13,89.06,428.83],[20.62,43.43,1009.93,64.02,449.07],[26.02,71.94,1009.38,64.12,435.21],[12.75,44.2,1017.59,81.22,471.03],[12.87,48.04,1012.47,100.13,465.56],[25.77,62.96,1019.86,58.07,442.83],[14.84,41.48,1017.26,63.42,460.3],[7.41,40.71,1023.07,83.32,474.25],[8.87,41.82,1033.3,74.28,477.97],[9.69,40.46,1019.1,71.91,472.16],[16.17,46.97,1014.22,85.8,456.08],[26.24,49.82,1014.9,55.58,452.41],[13.78,43.22,1011.31,69.7,463.71],[26.3,67.07,1006.26,63.79,433.72],[17.37,57.76,1016,86.59,456.4],[23.6,48.98,1015.41,48.28,448.43],[8.3,36.08,1020.63,80.42,481.6],[18.86,42.18,1001.16,98.58,457.07],[22.12,49.39,1019.8,72.83,451],[28.41,75.6,1018.48,56.07,440.28],[29.42,71.32,1002.26,67.13,437.47],[18.61,67.71,1004.07,84.49,443.57],[27.57,69.84,1004.91,68.37,426.6],[12.83,41.5,1013.12,86.07,470.87],[9.64,39.85,1012.9,83.82,478.37],[19.13,58.66,1013.32,74.86,453.92],[15.92,40.56,1020.79,53.52,470.22],[24.64,72.24,1011.37,80.61,434.54],[27.62,63.9,1013.11,43.56,442.89],[8.9,36.24,1013.29,89.35,479.03],[9.55,43.99,1020.5,97.28,476.06],[10.57,36.71,1022.62,80.49,473.88],[19.8,57.25,1010.84,88.9,451.75],[25.63,56.85,1012.68,49.7,439.2],[24.7,58.46,1015.58,68.64,439.7],[15.26,46.18,1013.68,98.58,463.6],[20.06,52.84,1004.21,82.12,447.47],[19.84,56.89,1013.23,78.32,447.92],[11.49,44.63,1020.44,86.04,471.08],[23.74,72.43,1007.99,91.36,437.55],[22.62,51.3,1012.36,81.02,448.27],[29.53,72.39,998.47,76.05,431.69],[21.32,48.14,1016.57,71.81,449.09],[20.3,58.46,1015.93,82.13,448.79],[16.97,44.92,1025.21,74.27,460.21],[12.07,41.17,1013.54,71.32,479.28],[7.46,41.82,1032.67,74.59,483.11],[19.2,54.2,1011.46,84.44,450.75],[28.64,66.54,1010.43,43.39,437.97],[13.56,41.48,1008.53,87.2,459.76],[17.4,44.9,1020.5,77.11,457.75],[14.08,40.1,1015.48,82.81,469.33],[27.11,69.75,1009.74,85.67,433.28],[20.92,70.02,1010.23,95.58,444.64],[16.18,44.9,1021.3,74.46,463.1],[15.57,44.68,1022.01,90.02,460.91],[10.37,39.04,1023.95,81.93,479.35],[19.6,59.21,1017.65,86.29,449.23],[9.22,40.92,1021.83,85.43,474.51],[27.76,72.99,1007.81,71.66,435.02],[28.68,70.72,1009.43,71.33,435.45],[20.95,48.14,1013.3,67.72,452.38],[9.06,39.3,1019.73,84.23,480.41],[9.21,39.72,1019.54,74.44,478.96],[13.65,42.74,1026.58,71.48,468.87],[31.79,76.2,1007.89,56.3,434.01],[14.32,44.6,1013.85,68.13,466.36],[26.28,75.23,1011.44,68.35,435.28],[7.69,43.02,1014.51,85.23,486.46],[14.44,40.1,1015.51,79.78,468.19],[9.19,41.01,1022.14,98.98,468.37],[13.35,41.39,1019.17,72.87,474.19],[23.04,74.22,1009.52,90.93,440.32],[4.83,38.44,1015.35,72.94,485.32],[17.29,42.86,1014.38,72.3,464.27],[8.73,36.18,1013.66,77.74,479.25],[26.21,70.32,1007,78.29,430.4],[23.72,58.62,1016.65,69.1,447.49],[29.27,64.69,1006.85,55.79,438.23],[10.4,40.43,1025.46,75.09,492.09],[12.19,40.75,1015.13,88.98,475.36],[20.4,54.9,1016.68,64.26,452.56],[34.3,74.67,1015.98,25.89,427.84],[27.56,68.08,1010.8,59.18,433.95],[30.9,70.8,1008.48,67.48,435.27],[14.85,58.59,1014.04,89.85,454.62],[16.42,40.56,1020.36,50.62,472.17],[16.45,63.31,1015.96,83.97,452.42],[10.14,42.02,1003.19,96.51,472.17],[9.53,41.44,1018.01,80.09,481.83],[17.01,49.15,1021.83,84.02,458.78],[23.94,62.08,1022.47,61.97,447.5],[15.95,49.25,1019.04,88.51,463.4],[11.15,41.26,1022.67,81.83,473.57],[25.56,70.32,1009.07,90.63,433.72],[27.16,66.44,1011.2,73.37,431.85],[26.71,77.95,1012.13,77.5,433.47],[29.56,74.22,1007.45,57.46,432.84],[31.19,70.94,1007.29,51.91,436.6],[6.86,41.17,1020.12,79.14,490.23],[12.36,41.74,1020.58,69.24,477.16],[32.82,68.31,1010.44,41.85,441.06],[25.3,70.98,1007.22,95.1,440.86],[8.71,41.82,1033.08,74.53,477.94],[13.34,40.8,1026.56,64.85,474.47],[14.2,43.02,1012.18,57.07,470.67],[23.74,65.34,1013.7,62.9,447.31],[16.9,44.88,1018.14,72.21,466.8],[28.54,71.94,1007.4,65.99,430.91],[30.15,69.88,1007.2,73.67,434.75],[14.33,42.86,1010.82,88.59,469.52],[25.57,59.43,1008.88,61.19,438.9],[30.55,70.04,1010.51,49.37,429.56],[28.04,74.33,1013.53,48.65,432.92],[26.39,49.16,1005.68,56.18,442.87],[15.3,41.76,1022.57,71.56,466.59],[6.03,41.14,1028.04,87.46,479.61],[13.49,44.63,1019.12,70.02,471.08],[27.67,59.14,1016.51,61.2,433.37],[24.19,65.48,1018.8,60.54,443.92],[24.44,59.14,1016.74,71.82,443.5],[29.86,64.79,1017.37,44.8,439.89],[30.2,69.59,1008.9,67.32,434.66],[7.99,41.38,1021.95,78.77,487.57],[9.93,41.62,1013.76,96.02,464.64],[11.03,42.32,1017.26,90.56,470.92],[22.34,63.73,1014.37,83.19,444.39],[25.33,48.6,1002.54,68.45,442.48],[18.87,52.08,1005.25,99.19,449.61],[25.97,69.34,1009.43,88.11,435.02],[16.58,43.99,1021.81,79.29,458.67],[14.35,46.18,1016.63,87.76,461.74],[25.06,62.39,1008.09,82.56,438.31],[13.85,48.92,1011.68,79.24,462.38],[16.09,44.2,1019.39,67.24,460.56],[26.34,59.21,1013.37,58.98,439.22],[23.01,58.79,1009.71,84.22,444.64],[26.39,71.25,999.8,89.12,430.34],[31.32,71.29,1008.37,50.07,430.46],[16.64,45.87,1009.02,98.86,456.79],[13.42,41.23,994.17,95.79,468.82],[20.06,44.9,1008.79,70.06,448.51],[14.8,44.71,1014.67,41.71,470.77],[12.59,41.14,1025.79,86.55,465.74],[26.7,66.56,1005.31,71.97,430.21],[19.78,50.32,1008.62,96.4,449.23],[15.17,49.15,1021.91,91.73,461.89],[21.71,61.45,1010.97,91.62,445.72],[19.09,39.39,1013.36,59.14,466.13],[19.76,51.19,1008.38,92.56,448.71],[14.68,41.23,998.43,83.71,469.25],[21.3,66.86,1013.04,55.43,450.56],[16.73,39.64,1008.94,74.91,464.46],[12.26,41.5,1014.87,89.41,471.13],[14.77,48.06,1010.92,69.81,461.52],[18.26,59.15,1012.04,86.01,451.09],[27.1,79.74,1005.43,86.05,431.51],[14.72,40.83,1009.65,80.98,469.8],[26.3,51.43,1012.05,63.62,442.28],[16.48,48.92,1011.84,64.16,458.67],[17.99,43.79,1016.13,75.63,462.4],[20.34,59.8,1015.18,80.21,453.54],[25.53,62.96,1019.81,59.7,444.38],[31.59,58.9,1003.39,47.6,440.52],[30.8,69.14,1007.68,63.78,433.62],[10.75,45,1023.68,89.37,481.96],[19.3,44.9,1008.89,70.55,452.75],[4.71,39.42,1026.4,84.42,481.28],[23.1,66.05,1020.28,80.62,439.03],[32.63,73.88,1005.64,52.56,435.75],[26.63,74.16,1009.72,83.26,436.03],[24.35,58.49,1011.03,70.64,445.6],[15.11,56.03,1020.27,89.95,462.65],[29.1,50.05,1005.87,51.53,438.66],[21.24,50.32,1008.54,84.83,447.32],[6.16,39.48,1004.85,59.68,484.55],[7.36,41.01,1024.9,97.88,476.8],[10.44,39.04,1023.99,85.03,480.34],[26.76,48.41,1010.53,47.38,440.63],[16.79,44.6,1014.27,48.08,459.48],[10.76,40.43,1025.98,79.65,490.78],[6.07,38.91,1019.25,83.39,483.56],[27.33,73.18,1012.26,82.18,429.38],[27.15,59.21,1013.49,51.71,440.27],[22.35,51.43,1011.34,77.33,445.34],[21.82,65.27,1013.86,72.81,447.43],[21.11,69.94,1004.37,84.26,439.91],[19.95,50.59,1016.11,73.23,459.27],[7.45,39.61,1017.88,79.73,478.89],[15.36,41.66,1012.41,62.32,466.7],[15.65,43.5,1021.39,78.58,463.5],[25.31,74.33,1015.04,79.88,436.21],[25.88,63.47,1011.95,65.87,443.94],[24.6,63.94,1012.87,80.28,439.63],[22.58,41.54,1013.21,71.33,460.95],[19.69,59.14,1015.99,70.33,448.69],[25.85,75.08,1006.24,57.73,444.63],[10.06,37.83,1005.49,99.46,473.51],[18.59,39.54,1008.56,68.61,462.56],[18.27,50.16,1011.07,95.91,451.76],[8.85,40.43,1025.68,80.42,491.81],[30.04,68.08,1011.04,51.01,429.52],[26.06,49.02,1007.59,74.08,437.9],[14.8,38.73,1003.18,80.73,467.54],[23.93,64.45,1015.35,54.71,449.97],[23.72,66.48,1003.61,73.75,436.62],[11.44,40.55,1023.37,88.43,477.68],[20.28,63.86,1016.04,74.66,447.26],[27.9,63.13,1011.8,70.04,439.76],[24.74,59.39,1015.23,74.64,437.49],[14.8,58.2,1018.29,85.11,455.14],[8.22,41.03,1021.76,82.97,485.5],[27.56,66.93,1016.81,55.59,444.1],[32.07,70.94,1006.91,49.9,432.33],[9.53,44.03,1008.87,89.99,471.23],[13.61,42.34,1017.93,91.61,463.89],[22.2,51.19,1009.2,82.95,445.54],[21.36,59.54,1007.99,92.62,446.09],[23.25,63.86,1017.82,59.64,445.12],[23.5,59.21,1018.29,63,443.31],[8.46,39.66,1015.14,85.38,484.16],[8.19,40.69,1019.86,85.23,477.76],[30.67,71.29,1008.36,52.08,430.28],[32.48,62.04,1010.39,38.05,446.48],[8.99,36.66,1028.11,71.98,481.03],[13.77,47.83,1007.41,90.66,466.07],[19.05,67.32,1013.2,83.14,447.47],[21.19,55.5,1019.83,65.22,455.93],[10.12,40,1021.15,91.67,479.62],[24.93,47.01,1014.28,66.04,455.06],[8.47,40.46,1019.87,78.19,475.06],[24.52,56.85,1012.59,54.47,438.89],[28.55,69.84,1003.38,67.26,432.7],[20.58,50.9,1011.89,72.56,452.6],[18.31,46.21,1010.46,82.15,451.75],[27.18,71.06,1008.16,86.32,430.66],[4.43,38.91,1019.04,88.17,491.9],[26.02,74.78,1010.04,72.78,439.82],[15.75,39,1015.91,69.58,460.73],[22.99,60.95,1015.14,69.86,449.7],[25.52,59.15,1013.88,65.37,439.42],[27.04,65.06,1013.33,52.37,439.84],[6.42,35.57,1025.58,79.63,485.86],[17.04,40.12,1011.81,83.14,458.1],[10.79,39.82,1012.89,88.25,479.92],[20.41,56.03,1019.94,55.85,458.29],[7.36,40.07,1017.29,52.55,489.45],[28.08,73.42,1012.17,62.74,434],[24.74,69.13,1010.69,90.08,431.24],[28.32,47.93,1003.26,54.5,439.5],[16.71,40.56,1019.48,49.88,467.46],[30.7,71.58,1010,48.96,429.27],[18.42,58.95,1016.95,86.77,452.1],[10.62,42.02,999.83,96.66,472.41],[22.18,69.05,1002.75,70.84,442.14],[22.38,49.3,1003.56,83.83,441],[13.94,41.58,1020.76,68.22,463.07],[21.24,60.84,1017.99,82.22,445.71],[6.76,39.81,1017.11,87.9,483.16],[26.73,68.84,1010.75,66.83,440.45],[7.24,38.06,1020.6,85.36,481.83],[10.84,40.62,1015.53,60.9,467.6],[19.32,52.84,1004.29,83.51,450.88],[29,69.13,1001.22,52.96,425.5],[23.38,54.42,1013.95,73.02,451.87],[31.17,69.51,1010.51,43.11,428.94],[26.17,48.6,1002.59,61.41,439.86],[30.9,73.42,1011.21,65.32,433.44],[24.92,73.68,1015.12,93.68,438.23],[32.77,71.32,1007.68,42.39,436.95],[14.37,40.56,1021.67,68.18,470.19],[8.36,40.22,1011.6,89.18,484.66],[31.45,68.27,1007.56,64.79,430.81],[31.6,73.17,1010.05,43.48,433.37],[17.9,48.98,1014.17,80.4,453.02],[20.35,50.9,1012.6,72.43,453.5],[16.21,41.23,995.88,80,463.09],[19.36,44.6,1016.25,45.65,464.56],[21.04,65.46,1017.22,63.02,452.12],[14.05,40.69,1015.66,74.39,470.9],[23.48,64.15,1021.08,57.77,450.89],[21.91,63.76,1009.85,76.8,445.04],[24.42,63.07,1011.49,67.39,444.72],[14.26,40.92,1022.07,73.96,460.38],[21.38,58.33,1013.05,72.75,446.8],[15.71,44.06,1018.34,71.69,465.05],[5.78,40.62,1016.55,84.98,484.13],[6.77,39.81,1017.01,87.68,488.27],[23.84,49.21,1013.85,50.36,447.09],[21.17,58.16,1017.16,68.11,452.02],[19.94,58.96,1014.16,66.27,455.55],[8.73,41.92,1029.41,89.72,480.99],[16.39,41.67,1012.96,61.07,467.68]],"arguments":{},"schema":[{"name":"AT","type":"double"},{"name":"V","type":"double"},{"name":"AP","type":"double"},{"name":"RH","type":"double"},{"name":"PE","type":"double"}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null},"errorSummary":null,"error":null,"startTime":1442967329007,"submitTime":1442967326122,"finishTime":1442967330027,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"0f6df9b8-b3e7-44f6-b0b8-14c3a9dfcc93","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9075","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9076,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"9f824df3-3fbd-437b-b13d-8d713d84e083","subtype":"command","commandType":"auto","position":9.875,"command":"%md Next, let's register our dataframe as an SQL table.  Because this lab may be run many times, we'll take the precaution of removing any existing tables first.\n\n**ToDo:** Execute the prepared code in the following cell...","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967326172,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"e08ce7a2-4816-49cc-aeb8-65e1d1f3e497","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9076","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9077,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"544a7044-dac1-46f0-ab3b-daf69cd364e0","subtype":"command","commandType":"auto","position":9.9375,"command":"sqlContext.sql(\"DROP TABLE IF EXISTS power_plant\")\ndbutils.fs.rm(\"dbfs:/user/hive/warehouse/power_plant\", True)\n","commandVersion":0,"results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">5</span><span class=\"ansired\">]: </span>False\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-67-64978ae151b9&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      2</span> dbutils<span class=\"ansiyellow\">.</span>fs<span class=\"ansiyellow\">.</span>rm<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;dbfs:/user/hive/warehouse/power_plant&quot;</span><span class=\"ansiyellow\">,</span> True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 4</span><span class=\"ansiyellow\"> </span>powerPlant<span class=\"ansiyellow\">.</span>write<span class=\"ansiyellow\">.</span>saveAsTable<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;power_plant&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/home/ubuntu/databricks/spark/python/pyspark/sql/readwriter.pyc</span> in <span class=\"ansicyan\">saveAsTable</span><span class=\"ansiblue\">(self, name, format, mode, partitionBy, **options)</span>\n<span class=\"ansigreen\">    324</span>         <span class=\"ansigreen\">if</span> format <span class=\"ansigreen\">is</span> <span class=\"ansigreen\">not</span> None<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    325</span>             self<span class=\"ansiyellow\">.</span>format<span class=\"ansiyellow\">(</span>format<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 326</span><span class=\"ansiyellow\">         </span>self<span class=\"ansiyellow\">.</span>_jwrite<span class=\"ansiyellow\">.</span>saveAsTable<span class=\"ansiyellow\">(</span>name<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    327</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    328</span>     <span class=\"ansiyellow\">@</span>since<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1.4</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/home/ubuntu/databricks/spark/python/lib/py4j-0.8.2.1-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">    536</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    537</span>         return_value = get_return_value(answer, self.gateway_client,\n<span class=\"ansigreen\">--&gt; 538</span><span class=\"ansiyellow\">                 self.target_id, self.name)\n</span><span class=\"ansigreen\">    539</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    540</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/home/ubuntu/databricks/spark/python/lib/py4j-0.8.2.1-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    298</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    299</span>                     <span class=\"ansiblue\">&apos;An error occurred while calling {0}{1}{2}.\\n&apos;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 300</span><span class=\"ansiyellow\">                     format(target_id, &apos;.&apos;, name), value)\n</span><span class=\"ansigreen\">    301</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    302</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling o2418.saveAsTable.\n: java.lang.RuntimeException: Tables created with SQLContext must be TEMPORARY. Use a HiveContext instead.\n\tat scala.sys.package$.error(package.scala:27)\n\tat org.apache.spark.sql.execution.SparkStrategies$DDLStrategy$.apply(SparkStrategies.scala:356)\n\tat org.apache.spark.sql.catalyst.planning.QueryPlanner$$anonfun$1.apply(QueryPlanner.scala:58)\n\tat org.apache.spark.sql.catalyst.planning.QueryPlanner$$anonfun$1.apply(QueryPlanner.scala:58)\n\tat scala.collection.Iterator$$anon$13.hasNext(Iterator.scala:371)\n\tat org.apache.spark.sql.catalyst.planning.QueryPlanner.plan(QueryPlanner.scala:59)\n\tat org.apache.spark.sql.SQLContext$QueryExecution.sparkPlan$lzycompute(SQLContext.scala:948)\n\tat org.apache.spark.sql.SQLContext$QueryExecution.sparkPlan(SQLContext.scala:946)\n\tat org.apache.spark.sql.SQLContext$QueryExecution.executedPlan$lzycompute(SQLContext.scala:952)\n\tat org.apache.spark.sql.SQLContext$QueryExecution.executedPlan(SQLContext.scala:952)\n\tat org.apache.spark.sql.SQLContext$QueryExecution.toRdd$lzycompute(SQLContext.scala:955)\n\tat org.apache.spark.sql.SQLContext$QueryExecution.toRdd(SQLContext.scala:955)\n\tat org.apache.spark.sql.DataFrameWriter.saveAsTable(DataFrameWriter.scala:211)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:606)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:231)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:379)\n\tat py4j.Gateway.invoke(Gateway.java:259)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:133)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:207)\n\tat java.lang.Thread.run(Thread.java:745)\n\n</div>","startTime":1442967330038,"submitTime":1442967326210,"finishTime":1442967332056,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"4316cc7a-c858-4b06-8969-5989b64930e2","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9077","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9078,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"c6462aec-e307-4935-b614-fb94f69162ea","subtype":"command","commandType":"auto","position":9.953125,"command":"%md **ToDo:** Register your `powerPlant` dataframe as the table named `power_plant`","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967326239,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"b2d35dad-5bbf-4dfb-a50f-c1e8728060fe","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9078","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9079,"parentId":9064,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"ff42aae9-ccc3-45ec-934d-ce7950e16e4b","subtype":"command","commandType":"auto","position":9.9609375,"command":"powerPlant.registerAsTempTable(\"power_plant\")","commandVersion":0,"results":null,"errorSummary":"<span class=\"ansired\">AttributeError</span>: &apos;DataFrame&apos; object has no attribute &apos;registerAsTempTable&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AttributeError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-6-fa3773a26bd5&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>powerPlant<span class=\"ansiyellow\">.</span>registerAsTempTable<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;power_plant&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/home/ubuntu/databricks/spark/python/pyspark/sql/dataframe.pyc</span> in <span class=\"ansicyan\">__getattr__</span><span class=\"ansiblue\">(self, name)</span>\n<span class=\"ansigreen\">    700</span>         <span class=\"ansigreen\">if</span> name <span class=\"ansigreen\">not</span> <span class=\"ansigreen\">in</span> self<span class=\"ansiyellow\">.</span>columns<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    701</span>             raise AttributeError(\n<span class=\"ansigreen\">--&gt; 702</span><span class=\"ansiyellow\">                 &quot;&apos;%s&apos; object has no attribute &apos;%s&apos;&quot; % (self.__class__.__name__, name))\n</span><span class=\"ansigreen\">    703</span>         jc <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>apply<span class=\"ansiyellow\">(</span>name<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    704</span>         <span class=\"ansigreen\">return</span> Column<span class=\"ansiyellow\">(</span>jc<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AttributeError</span>: &apos;DataFrame&apos; object has no attribute &apos;registerAsTempTable&apos;\n</div>","startTime":1442967326301,"submitTime":1442967326301,"finishTime":1442967332270,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"31c19b96-664b-484e-bf58-319a802bd18d","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9079","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9080,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"bacbbc4f-fdc4-4134-a4bd-f18e8246e389","subtype":"command","commandType":"auto","position":9.96875,"command":"%md **ToDo:** Perform the query `SELECT * FROM power_plant`","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967326335,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"1cb6dc00-00ee-4022-98a4-84e7f6f00fa0","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9080","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9081,"parentId":9064,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"972ed2d6-c19e-4e4f-a4f5-dce6db8ed711","subtype":"command","commandType":"auto","position":10,"command":"%sql SELECT * FROM power_plant","commandVersion":0,"results":null,"errorSummary":"Command skipped","error":null,"startTime":1442967326402,"submitTime":1442967326402,"finishTime":1442967332303,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"c3121ba3-faec-4524-b953-8afb500528ed","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9081","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9082,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"b417041a-f53a-483b-96c4-da0c938a0294","subtype":"command","commandType":"auto","position":11,"command":"%md **ToDo:** Use the `desc power_plant` SQL command to describe the schema","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967326482,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"c938f8f9-50bd-42cc-b659-aef36fbdfef7","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9082","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9083,"parentId":9064,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"0d0ac1a4-98e2-4121-bcd1-da3e75d2eadb","subtype":"command","commandType":"auto","position":12,"command":"%sql desc power_plant","commandVersion":0,"results":null,"errorSummary":"Command skipped","error":null,"startTime":1442967326554,"submitTime":1442967326554,"finishTime":1442967332333,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"66204a31-f46c-4aac-ae24-16f708766d44","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9083","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9084,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"08cfaa3e-eed5-4afa-b80a-412ffa37797c","subtype":"command","commandType":"auto","position":13,"command":"%md **Schema Definition**\n\nOur schema definition from UCI appears below:\n\n- AT = Atmospheric Temperature in C\n- V = Exhaust Vacuum Speed\n- AP = Atmospheric Pressure\n- RH = Relative Humidity\n- PE = Power Output\n\nPE is our label or target. This is the value we are trying to predict given the measurements.\n\n*Reference [UCI Machine Learning Repository Combined Cycle Power Plant Data Set](https://archive.ics.uci.edu/ml/datasets/Combined+Cycle+Power+Plant)*","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967326589,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"f1e0d09a-13fc-4a14-bb52-a5c6b785d1df","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9084","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9085,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"27025a80-f9ae-42c2-ac17-79a57af41297","subtype":"command","commandType":"auto","position":14,"command":"%md **ToDo:** Display summary statistics for the the columns.  \n*Hint:* To access the table from python use `sqlContext.table(\"power_plant\")`  \n*Hint:* We can use the describe function with no parameters to get some basic stats for each column like count, mean, max, min and standard deviation. The describe function is a method attached to a dataframe. More information can be found in the [Spark API docs](https://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.DataFrame)  \n","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967326657,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"c605d7d7-eecb-4180-aa9e-4444e538e36e","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9085","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9086,"parentId":9064,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"1a470ffb-8168-4cdb-94a6-3426ef4f220b","subtype":"command","commandType":"auto","position":15,"command":"display(sqlContext.table(\"power_plant\").describe())","commandVersion":0,"results":null,"errorSummary":"Command skipped","error":null,"startTime":1442967326742,"submitTime":1442967326742,"finishTime":1442967332353,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"5dcc3c1e-dea8-4582-8173-38a5d5d5fa39","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9086","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9087,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"b5020c7b-8e56-4967-9263-22adaedd1377","subtype":"command","commandType":"auto","position":16,"command":"%md ##Step 4: Visualize Your Data\n\nTo understand our data, we will look for correlations between features and the label.  This can be important when choosing a model.  E.g., if features and a label are linearly correlated, a linear model like Linear Regression can do well; if the relationship is very non-linear, more complex models such as Decision Trees can be better. We use Databrick's built in visualization to view each of our predictors in relation to the label column as a scatter plot to see the correlation between the predictors and the label.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967326772,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"0cf7a241-00f9-4ae3-b738-e627e13f8fe8","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9087","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9088,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"3c8ff7d3-7969-4235-b9ce-f85815744a59","subtype":"command","commandType":"auto","position":16.5,"command":"%md **ToDo:** Do a scatter plot of Power(PE) as a function of Temperature (AT).  \n*Bonus:* Name the y-axis \"Power\" and the x-axis \"Temperature\"","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967326824,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"a3caa721-195a-4857-94ab-09bf781d7cf6","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9088","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9089,"parentId":9064,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"d288ec0a-316d-45f8-85be-3b67db95263d","subtype":"command","commandType":"auto","position":17,"command":"%sql select AT as Temperature, PE as Power from power_plant","commandVersion":0,"results":null,"errorSummary":"Command skipped","error":null,"startTime":1442967326862,"submitTime":1442967326862,"finishTime":1442967332371,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"scatterPlot","width":"1232.1818182468414","height":"632.1818182468414","xColumns":[],"yColumns":["Temperature","Power"],"pivotColumns":[],"pivotAggregation":"min","customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"a56edfef-c5f1-40bb-b49e-24ffc12e01db","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9089","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9090,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"7ebaf866-dc9b-40c1-aa8a-1e2332d14b96","subtype":"command","commandType":"auto","position":18,"command":"%md Notice there appears to be a strong linear correlation between temperature and Power Output","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967326895,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"582592e0-80e9-48e4-a2a6-4381814e759d","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9090","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9091,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"93e8481d-dda5-4e0b-95d2-598ee87f20fe","subtype":"command","commandType":"auto","position":18.5,"command":"%md **ToDo:** Do a scatter plot of Power(PE) as a function of ExhaustVacuum (V).  \n*Bonus:* Name the y-axis \"Power\" and the x-axis \"ExhaustVacuum\"","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967326979,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"4f0d0a52-1754-45ae-b2ad-6d5cc5b3fe95","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9091","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9092,"parentId":9064,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"d3bd50b2-38ea-442d-b7d5-d43bb44f9af2","subtype":"command","commandType":"auto","position":19,"command":"%sql select V as ExhaustVacuum, PE as Power from power_plant;","commandVersion":0,"results":null,"errorSummary":"Command skipped","error":null,"startTime":1442967327018,"submitTime":1442967327018,"finishTime":1442967332394,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"scatterPlot","width":"888.1818182468414","height":"489.18181824684143","xColumns":[],"yColumns":["Power","ExhaustVacuum"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"2bcc2ed0-dadf-45db-a956-902c44c831da","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9092","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9093,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"6dee6b43-6873-4671-be24-d5bc58ee013d","subtype":"command","commandType":"auto","position":20,"command":"%md The linear correlation is not as strong between Exhaust Vacuum Speed and Power Output but there is some semblance of a pattern.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967327045,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"61f040f1-e866-418e-8972-f5b223dc95c4","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9093","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9094,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"8c3bea83-d748-4414-a36c-4caf127330de","subtype":"command","commandType":"auto","position":20.5,"command":"%md **ToDo:** Do a scatter plot of Power(PE) as a function of Pressure (AP).  \n*Bonus:* Name the y-axis \"Power\" and the x-axis \"Pressure\"","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967327082,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"cccfc7de-1508-4262-af72-d44a54394da8","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9094","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9095,"parentId":9064,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"10490198-52a5-404f-a9fd-670b2b986ce9","subtype":"command","commandType":"auto","position":21,"command":"%sql select AP as Pressure, PE as Power from power_plant;","commandVersion":0,"results":null,"errorSummary":"Command skipped","error":null,"startTime":1442967327120,"submitTime":1442967327120,"finishTime":1442967332419,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"scatterPlot","width":"879.1818182468414","height":"456.18181824684143","xColumns":[],"yColumns":["Pressure","Power"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"f6462bea-6db5-4d04-a8bc-f4cfd6f5e5b2","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9095","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9096,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"3563d37b-7bff-468a-8481-df81a954f527","subtype":"command","commandType":"auto","position":21.5,"command":"%md **ToDo:** Do a scatter plot of Power(PE) as a function of Humidity (RH).  \n*Bonus:* Name the y-axis \"Power\" and the x-axis \"Humidity\"","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967327154,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"b64ea279-01af-4eef-a29b-a394f8a73b5d","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9096","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9097,"parentId":9064,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"ea01fc93-32db-445f-af54-8ef296b601a2","subtype":"command","commandType":"auto","position":22,"command":"%sql select RH Humidity, PE Power from power_plant;","commandVersion":0,"results":null,"errorSummary":"Command skipped","error":null,"startTime":1442967327191,"submitTime":1442967327191,"finishTime":1442967332447,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"scatterPlot","width":"880.1818182468414","height":"423.18181824684143","xColumns":[],"yColumns":["Humidity","Power"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"e2364b0c-3847-4fab-ac24-6c00dc585541","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9097","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9098,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"b28087ea-39fd-4f18-8b16-2aae1a179506","subtype":"command","commandType":"auto","position":23,"command":"%md ...and atmospheric pressure and relative humidity seem to have little to no linear correlation","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967327221,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"a4d36f80-a521-4b79-a2ae-5a1d0e686ea9","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9098","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9099,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"479c9bf7-f79f-4ef7-a1ee-752470d4d123","subtype":"command","commandType":"auto","position":24,"command":"%md ##Step 5: Data Preparation\n\nThe next step is to prepare the data. Since all of this data is numeric and consistent this is a simple task for us today.\n\nWe will need to convert the predictor features from columns to Feature Vectors using [pyspark.ml.feature.VectorAssembler](https://spark.apache.org/docs/latest/api/python/pyspark.ml.html#pyspark.ml.feature.VectorAssembler)\n\nThe VectorAssembler will be the first step in building our ML pipeline.\n","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967327259,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"7f16e4a3-3bc8-4d08-b05a-76658bba1a63","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9099","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9100,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"50ee58bd-bade-4acb-9e8f-d4dcc4173641","subtype":"command","commandType":"auto","position":24.5,"command":"%md\n**ToDo:** Assign the data frame to the local variable `dataset`  \n**ToDo:** Create a VectorAssembler named `vectorizer` to read your dataset.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967327309,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":[],"diffDeletes":[],"nuid":"27e0e266-99dd-4ec1-baf3-9de55d0d6df0","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9100","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9101,"parentId":9064,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"6b533d25-7ace-4de5-8d19-a73b5c9a53f1","subtype":"command","commandType":"auto","position":25,"command":"from pyspark.ml.feature import VectorAssembler\n#Finish here...\ndataset=None\nvectorizer=None","commandVersion":0,"results":null,"errorSummary":"Command skipped","error":null,"startTime":1442967327346,"submitTime":1442967327346,"finishTime":1442967332481,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"22fa838b-2762-48c7-81d6-64263b652ad2","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9101","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9102,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"477b894a-70d6-4df4-99bf-d22f8cb489c6","subtype":"command","commandType":"auto","position":26,"command":"%md ##Step 6: Data Modeling\nNow let's model our data to predict what the power output will be given a set of sensor readings\n\nOur first model will be based on simple linear regression since we saw some linear patterns in our data based on the scatter plots during the exploration stage.\n\nIn machine learning we often will split up our initial data set into a \"trainingSet\" used to train our model and a \"testSet\" to evaluate the model's performance in giving predictions.\n\n**ToDo:** Divide up the model into a trainingSet and a testSet.  Then cache each set into memory to maximize performance.   \n**Hint:** Use the [randomSplit](https://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.randomSplit) function.\n**Hint:** The data set won't actually be cached until you perform an action on the dataset.  \n*Tip*: For reproducability it's often best to use a predefined seed when doing the random sampling.\n\n","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967327368,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"8d97920f-0ad9-4753-884f-5719d4e6bbc1","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9102","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9103,"parentId":9064,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"20bec6e8-d64b-488d-956a-fb7b265a9f15","subtype":"command","commandType":"auto","position":27,"command":"(trainingSet, testSet) = (None, None)","commandVersion":0,"results":null,"errorSummary":"Command skipped","error":null,"startTime":1442967327409,"submitTime":1442967327409,"finishTime":1442967332502,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"a32bfa42-ddb7-489e-8108-6a7fddb178d6","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9103","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9104,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"5167e4ae-e357-4b3b-bd84-a1178256f49b","subtype":"command","commandType":"auto","position":28,"command":"%md Next we'll create a Linear Regression Model and use the built in help to identify how to train it.  See more details at [Linear Regression](https://spark.apache.org/docs/latest/api/python/pyspark.ml.html#pyspark.ml.regression.LinearRegression) in the ML guide.\n\n**ToDo**: Run the next cell.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967327440,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"621f7207-e2d9-4809-bda1-f0bd2bb685e2","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9104","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9105,"parentId":9064,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"b1ff1eec-af75-46b2-a01b-6a6e14b4bb15","subtype":"command","commandType":"auto","position":29,"command":"# ***** LINEAR REGRESSION MODEL ****\n\nfrom pyspark.ml.regression import LinearRegression\nfrom pyspark.ml.regression import LinearRegressionModel\nfrom pyspark.ml import Pipeline\n\n# Let's initialize our linear regression learner\nlr = LinearRegression()\n\n# We use explain params to dump the parameters we can use\nprint(lr.explainParams())","commandVersion":0,"results":null,"errorSummary":"Command skipped","error":null,"startTime":1442967327484,"submitTime":1442967327484,"finishTime":1442967332524,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"e7d7bafe-e079-4ab1-9f63-8aeaa663e28e","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9105","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9106,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"29d13870-9e6d-45f3-a8e2-efa872cd44d7","subtype":"command","commandType":"auto","position":31,"command":"%md The cell below is based on the Spark ML pipeline API. More information can be found in the Spark ML Programming Guide at https://spark.apache.org/docs/latest/ml-guide.html\n\n**ToDo:** Read, understand, and then run the next cell to train our linear regression model.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967327509,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"1b5f1054-f917-42b6-8b04-336902aa2f4c","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9106","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9107,"parentId":9064,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"a26be4ec-d368-4926-b501-67a462250b44","subtype":"command","commandType":"auto","position":32,"command":"# Now we set the parameters for the method\nlr.setPredictionCol(\"Predicted_PE\")\\\n  .setLabelCol(\"PE\")\\\n  .setMaxIter(100)\\\n  .setRegParam(0.1)\n\n# We will use the new spark.ml pipeline API. If you have worked with scikit-learn this will be very familiar.\nlrPipeline = Pipeline()\nlrPipeline.setStages([vectorizer, lr])\n\n# Let's first train on the entire dataset to see what we get\nlrModel = lrPipeline.fit(trainingSet)","commandVersion":0,"results":null,"errorSummary":"Command skipped","error":null,"startTime":1442967327596,"submitTime":1442967327596,"finishTime":1442967332549,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"c7d05065-8a91-4d7d-8f91-576369053dc1","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9107","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9108,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"726c933d-bccf-461c-a4a9-615ada138af8","subtype":"command","commandType":"auto","position":32.5,"command":"%md Now let's apply this model to the training set.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967327622,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"4603c785-cbf3-478e-855f-ee2d70ad154d","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9108","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9109,"parentId":9064,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"085108fb-490b-410b-8157-6295c8fcec0d","subtype":"command","commandType":"auto","position":32.75,"command":"predictionsAndLabels = lrModel.transform(testSet)\n\ndisplay(predictionsAndLabels.select(\"AT\", \"V\", \"AP\", \"RH\", \"PE\", \"Predicted_PE\"))\n","commandVersion":0,"results":null,"errorSummary":"Command skipped","error":null,"startTime":1442967327660,"submitTime":1442967327660,"finishTime":1442967332568,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"e89436ff-01d1-4174-a05d-3ad13dbbdd22","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9109","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9110,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"f4bc15b1-9f3c-4cbc-b260-75ac4f6e6143","subtype":"command","commandType":"auto","position":33,"command":"%md \nSince Linear Regression is Simply a Line of best fit over the data that minimizes the square of the error, given multiple input dimensions we can express each predictor as a line function of the form:\n\n\\\\[ y = a + b x_1 + b x_2 + b x_i ... \\\\]\n\nwhere a is the intercept and b are coefficients.\n\nTo express the coefficients of that line we can retrieve the Estimator stage from the PipelineModel and express the weights and the intercept for the function.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967327684,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"1d2f777f-6b4e-4014-910f-c6a827a2c58c","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9110","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9111,"parentId":9064,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"4c0c48fd-cb30-4a95-a090-1273a2b99229","subtype":"command","commandType":"auto","position":34,"command":"# The intercept is as follows:\nintercept = lrModel.stages[1].intercept\nprint(intercept)\n","commandVersion":0,"results":null,"errorSummary":"Command skipped","error":null,"startTime":1442967327721,"submitTime":1442967327721,"finishTime":1442967332588,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"bcd176f4-87ba-4fb5-b7a4-d56400409e3a","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9111","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9112,"parentId":9064,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"9e5799fe-99dd-4ba4-b381-e94943f1a789","subtype":"command","commandType":"auto","position":35,"command":"# The coefficents (i.e. weights) are as follows:\n\nweights = lrModel.stages[1].weights.toArray()\n\n\nfeaturesNoLabel = [col for col in dataset.columns if col != \"PE\"]\n\ncoefficents = sc.parallelize(weights).zip(sc.parallelize(featuresNoLabel))\n\n# Now let's sort the coeffecients from the most to the least\n\nequation = \"y = {intercept}\".format(intercept=intercept)\nvariables = []\nfor x in coefficents.sortByKey().collect():\n    weight = abs(x[0])\n    name = x[1]\n    symbol = \"+\" if (x[0] > 0) else \"-\"\n    equation += (\" {} ({} * {})\".format(symbol, weight, name))\n\n# Finally here is our equation\nprint(\"Linear Regression Equation: \" + equation)","commandVersion":0,"results":null,"errorSummary":"Command skipped","error":null,"startTime":1442967327747,"submitTime":1442967327747,"finishTime":1442967332611,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"041b37f4-08e1-431c-95f8-be4162e8b1a9","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9112","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9113,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"1c3c5063-32b4-4100-a0e1-e50b9c576283","subtype":"command","commandType":"auto","position":37,"command":"%md Based on examining the output it shows there is a strong negative correlation between Atmospheric Temperature (AT) and Power Output.\n\nBut our other dimenensions seem to have little to no correlation with Power Output. Do you remember **Step 2: Explore Your Data**? When we visualized each predictor against Power Output using a Scatter Plot, only the temperature variable seemed to have a linear correlation with Power Output so our final equation seems logical.\n\n\nNow let's see what our predictions look like given this model.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967327774,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"e20819c3-b690-4ba0-bc4e-30ec66bd4522","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9113","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9114,"parentId":9064,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"8e3e6007-0f89-4d62-b653-cdd4d62e017c","subtype":"command","commandType":"auto","position":38,"command":"predictionsAndLabels = lrModel.transform(testSet)\n\ndisplay(predictionsAndLabels.select(\"AT\", \"V\", \"AP\", \"RH\", \"PE\", \"Predicted_PE\"))","commandVersion":0,"results":null,"errorSummary":"Command skipped","error":null,"startTime":1442967327813,"submitTime":1442967327813,"finishTime":1442967332633,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"de0513c4-736b-45f0-87dd-610ce7e091ec","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9114","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9115,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"d5eeaf6d-d118-4a8d-895a-6d6976b22172","subtype":"command","commandType":"auto","position":39,"command":"%md Now that we have real predictions we can use an evaluation metric such as Root Mean Squared Error to validate our regression model. The lower the Root Mean Squared Error, the better our model.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967327837,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"266959b5-2f10-403d-a01b-82adfa7c94b7","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9115","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9116,"parentId":9064,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"4b394265-ef9a-4f02-8115-cdecc2771547","subtype":"command","commandType":"auto","position":40,"command":"# Now let's compute some evaluation metrics against our test dataset\n\nfrom pyspark.mllib.evaluation import RegressionMetrics\n\nmetrics = RegressionMetrics(predictionsAndLabels.select(\"Predicted_PE\", \"PE\").rdd.map(lambda r: (float(r[0]), float(r[1]))))\n\nrmse = metrics.rootMeanSquaredError\nexplainedVariance = metrics.explainedVariance\nr2 = metrics.r2\n\nprint(\"Root Mean Squared Error: {}\".format(rmse))\nprint(\"Explained Variance: {}\".format(explainedVariance))\nprint(\"R2: {}\".format(r2))","commandVersion":0,"results":null,"errorSummary":"Command skipped","error":null,"startTime":1442967327874,"submitTime":1442967327874,"finishTime":1442967332654,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"23980356-9d57-4367-951e-f3b23a94b0da","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9116","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9117,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"e3c90ead-5867-4a98-b16d-faf4f2299d09","subtype":"command","commandType":"auto","position":41,"command":"%md Generally a good model will have 68% of predictions within 1 RMSE and 95% within 2 RMSE of the actual value. Let's calculate and see if a RMSE of 4.51 meets this criteria.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967327901,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"5a0931fc-1fa7-411a-8560-277486531bb6","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9117","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9118,"parentId":9064,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"8a6f9bfd-25eb-4b6e-912c-bdbfc03b41fc","subtype":"command","commandType":"auto","position":42,"command":"# First we calculate the residual error and divide it by the RMSE\npredictionsAndLabels.selectExpr(\"PE\", \"Predicted_PE\", \"PE - Predicted_PE Residual_Error\", \"(PE - Predicted_PE) / {} Within_RSME\".format(rmse)).registerTempTable(\"Power_Plant_RMSE_Evaluation\")","commandVersion":0,"results":null,"errorSummary":"Command skipped","error":null,"startTime":1442967327946,"submitTime":1442967327946,"finishTime":1442967332678,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"3f2f9f2e-85bf-4c74-a1ec-755ab06941a4","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9118","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9119,"parentId":9064,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"cda9e132-8cb9-4a50-afe8-da9cc8bad5bd","subtype":"command","commandType":"auto","position":43,"command":"%sql SELECT * from Power_Plant_RMSE_Evaluation","commandVersion":0,"results":null,"errorSummary":"Command skipped","error":null,"startTime":1442967327970,"submitTime":1442967327970,"finishTime":1442967332701,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"7dd2183b-a59e-4576-8ee5-67f9e42c8fb0","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9119","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9120,"parentId":9064,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"1beeabbc-06bc-4968-bda3-2cac2892289a","subtype":"command","commandType":"auto","position":44,"command":"%sql -- Now we can display the RMSE as a Histogram. Clearly this shows that the RMSE is centered around 0 with the vast majority of the error within 2 RMSEs.\nSELECT Within_RSME  from Power_Plant_RMSE_Evaluation","commandVersion":0,"results":null,"errorSummary":"Command skipped","error":null,"startTime":1442967327994,"submitTime":1442967327994,"finishTime":1442967332841,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"histogram","width":"933.1818182468414","height":"439.18181824684143","xColumns":["<id>"],"yColumns":["Within_RSME"],"pivotColumns":[],"pivotAggregation":"count","customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"6634562b-4d64-46f4-bb81-c214b5bb020b","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9120","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9121,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"f42e3d94-f851-40fb-a06d-02c62b7b57d2","subtype":"command","commandType":"auto","position":45,"command":"%md We can see this definitively if we count the number of predictions within + or - 1.0 and + or - 2.0 and display this as a pie chart:","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967328024,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"80dbb6e6-5d23-44bd-926c-535b5936d610","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9121","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9122,"parentId":9064,"deltaVersion":0,"running":false,"state":"error","shouldRun":false,"rerunning":false,"stages":[],"guid":"ae350762-4b1a-4871-9330-602e8c130a22","subtype":"command","commandType":"auto","position":46,"command":"%sql SELECT case when Within_RSME <= 1.0 and Within_RSME >= -1.0 then 1  when  Within_RSME <= 2.0 and Within_RSME >= -2.0 then 2 else 3 end RSME_Multiple, COUNT(*) count  from Power_Plant_RMSE_Evaluation\ngroup by case when Within_RSME <= 1.0 and Within_RSME >= -1.0 then 1  when  Within_RSME <= 2.0 and Within_RSME >= -2.0 then 2 else 3 end","commandVersion":0,"results":null,"errorSummary":"Command skipped","error":null,"startTime":1442967328070,"submitTime":1442967328070,"finishTime":1442967332866,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"pieChart","width":"764.1818182468414","height":"363.18181824684143","xColumns":["RSME_Multiple"],"yColumns":["count"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"a85b145e-5205-4810-8057-a327898eb007","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9122","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":9123,"parentId":9064,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"624591a1-f445-4111-b2a2-e2b6f10f8bf4","subtype":"command","commandType":"auto","position":47,"command":"%md So we have 68% of our training data within 1 RMSE and 97% (68% + 29%) within 2 RMSE. So the model is pretty decent. Let's see if we can tune the model to improve it further.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1442967328098,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"yuecong1104@gmail.com","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"14f02669-342c-4f60-a29e-0aa1aa291ab1","globalVars":{},"iPythonMetadata":null,"path":"/1/3561/8446/8688/8863/9064/9123","parent":null,"localVersion":63,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"dashboardV2","id":9065,"parentId":9064,"defaultSize":{"width":1024,"height":768},"guid":"ad4d000b-d2a4-419e-ba75-771d9208289d","globalVars":{},"path":"/1/3561/8446/8688/8863/9064/9065","parent":null,"nuid":"c9de5545-c6eb-44a6-a583-903123b4d0f0","presenceMarks":[]}];</script>

<script>
var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/201510301624390700-ce350f0a9622b7b742da5cf8d5cb0e2b75e1c4c7-dirty/notebook-main.js';
var s = document.createElement('script');
var b = document.getElementsByTagName('body')[0];
b.appendChild(s);
s.onerror = function() {
  var c = document.createElement('div');
  c.innerHTML = '<h1>Network Error</h1><p><b>Please check your network connection and try again.</b></p><p>Could not load a required resource: ' + u + '</p>';
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
};
s.src = u;
</script>
</body>
</html>